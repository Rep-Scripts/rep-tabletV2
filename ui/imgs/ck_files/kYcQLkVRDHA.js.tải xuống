;/*FB_PKG_DELIM*/

__d("LSInitiateThreadMigration",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return a[3]!==f?(d[0]=new c.Map(),d[0].set("open_message_thread_key",a[0]),d[0].set("armadillo_thread_key",a[1]),d[0].set("trace_id",a[3]),d[0].set("should_copy_messages",a[2]),d[1]=d[0].get("open_message_thread_key"),d[0],d[2]=d[0].get("armadillo_thread_key"),d[0],d[3]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),[c.i64.to_string(d[1]),"_",c.i64.to_string(d[2])].join(""),c.i64.cast([0,436]),d[3],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0]))):(d[0]=new c.Map(),d[0].set("open_message_thread_key",a[0]),d[0].set("armadillo_thread_key",a[1]),d[0].set("should_copy_messages",a[2]),d[1]=d[0].get("open_message_thread_key"),d[0],d[2]=d[0].get("armadillo_thread_key"),d[0],d[3]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),[c.i64.to_string(d[1]),"_",c.i64.to_string(d[2])].join(""),c.i64.cast([0,436]),d[3],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0])))},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSOptimisticAcceptMessageRequest",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(e,g){g=e.done;e=e.value;return g?0:(e.item,c.seq([function(b){return c.fe(c.db.table(9).fetch([[[a[0]]]]),function(b){var d=b.update;b.item;return d({folderName:"inbox",parentThreadKey:c.i64.cast([0,0]),igFolder:a[1]})})},function(b){return c.db.table(173).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[4]=b.clientThreadPk,c.db.table(276).fetch([[[d[4]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?0:(a.item,c.fe(c.db.table(276).fetch([[[d[4]]]]),function(a){var b=a.update;a.item;return b({folderType:c.i64.cast([0,0])})}))}))})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],f)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("sync_group",d[0]),d[2].set("ig_folder",a[1]),d[3]=c.toJSON(d[2]),c.sp(b("LSIssueNewTask"),"message_request",c.i64.cast([0,66]),d[3],f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),f,f,c.i64.cast([0,0]))}]))})},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSOptimisticSendXMAMessageForwardFromSecureThread",["LSArrayGetObjectAt","LSIssueNewTaskAndGetTaskID","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return c.sp(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],f,f,f,f,f,f,c.i64.cast([0,3]),a[4],f,f,!0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return d[3]=c.i64.of_int32(a[6].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[4]=e,c.seq([function(e){return c.ntop("Array",b("LSArrayGetObjectAt"),a[6],d[4]).then(function(a){return a=a,d[5]=a[0],d[6]=a[1],a})},function(e){return d[7]=d[5].get("attachment_fbid"),d[5],d[8]=d[5].get("offline_attachment_id"),d[5],d[9]=d[5].get("attachment_type"),d[5],d[10]=d[5].get("filename"),d[5],d[11]=d[5].get("filesize"),d[5],d[12]=d[5].get("attachment_index"),d[5],d[13]=d[5].get("has_media"),d[5],d[14]=d[5].get("has_xma"),d[5],d[15]=d[5].get("playable_url"),d[5],d[16]=d[5].get("playable_url_mime_type"),d[5],d[17]=d[5].get("playable_duration_ms"),d[5],d[18]=d[5].get("preview_url"),d[5],d[19]=d[5].get("preview_url_mime_type"),d[5],d[20]=d[5].get("mini_preview"),d[5],d[21]=d[5].get("preview_width"),d[5],d[22]=d[5].get("preview_height"),d[5],d[23]=d[5].get("xma_layout_type"),d[5],d[24]=d[5].get("xmas_template_type"),d[5],d[25]=d[5].get("cta1_title"),d[5],d[26]=d[5].get("cta2_title"),d[5],d[27]=d[5].get("cta3_title"),d[5],d[28]=d[5].get("image_url"),d[5],d[29]=d[5].get("action_url"),d[5],d[30]=d[5].get("title_text"),d[5],d[31]=d[5].get("subtitle_text"),d[5],d[32]=d[5].get("description_text"),d[5],d[33]=d[5].get("source_text"),d[5],d[34]=d[5].get("original_file_hash"),d[5],d[35]=d[5].get("sound_bite_client_sound_key"),d[5],d[36]=d[5].get("sound_bite_visual"),d[5],d[37]=d[5].get("ephemeral_media_state"),d[5],c.seq([function(b){return c.fe(c.ftr(c.db.table(16).fetch([[[a[1],d[0],d[7]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===d[0]&&b.attachmentFbid===d[7]&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(16).add({threadKey:a[1],messageId:d[0],attachmentFbid:d[7],timestampMs:d[1],offlineAttachmentId:d[8],attachmentType:d[9],filename:d[10],filesize:d[11],attachmentIndex:d[12],hasMedia:d[13],hasXma:d[14],isSharable:!1,playableUrl:d[15],playableUrlMimeType:d[16],playableDurationMs:d[17],previewUrl:d[18],previewUrlMimeType:d[19],miniPreview:d[20],previewWidth:d[21],previewHeight:d[22],xmaLayoutType:d[23],xmasTemplateType:d[24],cta1Title:d[25],cta2Title:d[26],cta3Title:d[27],imageUrl:d[28],actionUrl:d[29],titleText:d[30],subtitleText:d[31],descriptionText:d[32],sourceText:d[33],ephemeralMediaState:d[37],originalFileHash:d[34],authorityLevel:c.i64.cast([0,20])})},function(e){return c.sp(b("LSSetMessageDisplayedContentTypes"),a[1],d[0],d[1],a[3],!1,!1)},function(e){return c.sp(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[0],d[7],d[15],f,f,d[16],d[18],f,f,d[19],d[21],d[22])}])}])}):c.resolve()},function(e){return c.sp(b("LSIssueNewTaskAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),f,c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[2],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[5],sendType:c.i64.cast([0,11]),markThreadRead:!1})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("MAWShareAttachment_LinkPreviewQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5728355667179018"}),null);
__d("MAWShareAttachment_LinkPreviewQuery.graphql",["MAWShareAttachment_LinkPreviewQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"url"}],c=[{alias:null,args:[{fields:[{kind:"Variable",name:"url",variableName:"url"}],kind:"ObjectValue",name:"params"}],kind:"ScalarField",name:"post_reshare_xma",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MAWShareAttachment_LinkPreviewQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MAWShareAttachment_LinkPreviewQuery",selections:c},params:{id:b("MAWShareAttachment_LinkPreviewQuery_facebookRelayOperation"),metadata:{},name:"MAWShareAttachment_LinkPreviewQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("useMWFetchAudioWaveformDataForAttachmentQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9424167954321558"}),null);
__d("useMWFetchAudioWaveformDataForAttachmentQuery.graphql",["useMWFetchAudioWaveformDataForAttachmentQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"attachmentFbid"}],c=[{kind:"Variable",name:"id",variableName:"attachmentFbid"}],d={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"waveform_data",storageKey:null}],type:"MessageAudio",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"useMWFetchAudioWaveformDataForAttachmentQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"useMWFetchAudioWaveformDataForAttachmentQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:b("useMWFetchAudioWaveformDataForAttachmentQuery_facebookRelayOperation"),metadata:{},name:"useMWFetchAudioWaveformDataForAttachmentQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("MAWInternalLog",["WALoggerDeferred","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);h=function(){return a};return a}function a(a){c("gkx")("2099")&&void d("WALoggerDeferred").LOG(h(),a)}g.internalLog=a}),98);
__d("MAWThreadEvent",["MAWBridge","MAWBridgeSendAndReceive","MAWJobDefinitions","MAWUIJob","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";b="placeholderConvertSubscription";function a(a){d("MAWBridge").getBridge().setHandlers("threadEvent",{placeholderConvertSubscription:function(b){var e=b.chatJid;b=b.msgId;a===e&&c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:b}).then(function(a){if(a==null)return;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").jobSerializers.markThreadAsRead(e,a))}))}})}g.PLACEHOLDER_CONVERT_SUBSCRIPTION=b;g.setThreadEventHandler=a}),98);
__d("MAWCreateGroupThread",["fbt","I64","LSFactory","LSIssueNewError","MAWBridgeSendAndReceive","MAWJobDefinitions","MAWTimedJob","WAJobOrchestratorTypes","asyncToGeneratorRuntime","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.db,e=a.deduplicationKey,f=a.isDualSend;f=f===void 0?!1:f;var g=a.offlineThreadingId,i=a.participantIds;a=a.threadName;g=g!=null?d("I64").to_string(g):void 0;var j="msgr";e=(yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("createGroup",{extras:{clientThreadKey:g,deduplicationKey:e,isDualSend:f,platform:j},key:g,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},subject:a,uniqKey:g,users:i})));a=e.error;g=e.value;if(a==null&&g!=null&&g.type===j){i=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getThreadIdByChatJid",{chatJid:g.chatJid}));if(i==null)throw c("unrecoverableViolation")("Group was not found in database","messenger_e2ee_web");else return{chatId:i,created:!0,jid:g.chatJid}}if(!f){var k=h._("__JHASH__Q8EKHlLB3en__JHASH__").toString();c("promiseDone")(b.runInTransaction(function(a){return c("LSIssueNewError")(void 0,void 0,k,k,void 0,void 0,c("LSFactory")(a))},"readwrite"))}throw c("unrecoverableViolation")("Unable to create group","messenger_e2ee_web")});return j.apply(this,arguments)}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.deduplicationKey;if(b==null)return i(a);b=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getThreadIdByDeduplicationKey",{deduplicationKey:b}));return b!=null?{chatId:b.chatId,created:!1,jid:b.jid}:i(a)});return k.apply(this,arguments)}g["default"]=a}),98);
__d("MAWMiActMaybeCreateActThread",["FBLogger","I64","LSAuthorityLevel","LSFactory","LSIntEnum","LSMessagingThreadTypeUtil","LSVerifyE2EEMetadataThreadExistsV2","MAWCreateGroupThread","MAWCreateOneToOneThread","MAWGating","MAWMiActCreateThreadInActWithMiData","MAWMiActGetThreadLifecycleState","MAWMiActThreadLifecycleState","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return a.runInTransaction(function(a){return c("LSVerifyE2EEMetadataThreadExistsV2")(d("LSIntEnum").ofNumber(15),b,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE),c("LSFactory")(a)).then(function(){})},"readwrite")}function i(a,b,e){if(e==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] Could not create optimistic thread because data was null\n      for threadKey: %s",d("I64").to_string(b.threadKey));var f=e.actorId;e=e.participantIds;var g=e.filter(function(a){return a!==d("I64").to_string(f)});if(d("LSMessagingThreadTypeUtil").isOneToOne(b.threadType)&&(g.length===1||d("MAWGating").isChatWithYourselfEnabled())){var h=g.length===1?g:e;return d("MAWCreateOneToOneThread").call(a,d("I64").of_string(h[0]),d("I64").to_string(b.threadKey))}else if(d("LSMessagingThreadTypeUtil").isGroup(b.threadType)&&g.length>1)return c("MAWCreateGroupThread")({db:a,offlineThreadingId:b.threadKey,participantIds:e});throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] Did not know which type of optimistic thread to create for\n    threadKey: %s, participantsCount: %s, threadType: %s",d("I64").to_string(b.threadKey),e.length,d("LSIntEnum").toNumber(b.threadType))}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("MAWMiActCreateThreadInActWithMiData").miActCreateThreadInActWithMiData(a.serverThreadKey,a.jidInt64,a.thread.lastActivityTimestampMs,a.thread.lastReadWatermarkTimestampMs,d("LSMessagingThreadTypeUtil").isGroup(a.thread.threadType)));return{chatId:a.chatId,created:a.isCreated,jid:a.chatJid}});return k.apply(this,arguments)}var l=new Map();function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByThreadKey(a,b,"maybeCreateActThread"));switch(f.type){case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.THREAD_KEY_ONLY:yield h(a,b);throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] We did not call MiActLoadExistingThread for threadKey: %s, threadState: %s",d("I64").to_string(b),f.type);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_MISSING_MAPPING_ROW:throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] MI inserted the thread but the mapping row was not\n        written or it was deleted for threadKey: %s",d("I64").to_string(b));case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_NO_ACT:var g=d("I64").to_string(b),k=l.get(g);if(k!=null)return k;k=i(a,f.thread,e);l.set(g,k);return k;case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.OPTIMISTIC_THREAD_WITH_ACT:return{chatId:f.chatId,created:!1,jid:f.jid};case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.AUTHORITATIVE_THREAD_ONLY:return j(f);case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.MI_AND_ACT_THREAD_COMPLETE:return{chatId:f.chatId,created:!1,jid:f.jid};case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY_BY_CHAT_ID:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.ACT_THREAD_ONLY_BY_JID:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.CLIENT_PARTIAL_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.SERVER_PARTIAL_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MI_THREAD:case d("MAWMiActThreadLifecycleState").MiActThreadStatesEnum.JID_MISSING_MAPPING_ROW:throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] Unhandled ACT thread creation state for threadKey:\n        %s",d("I64").to_string(b));default:f.type;throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] Unreachable miActThreadState.type: %s",f.type)}});return m.apply(this,arguments)}g["default"]=a}),98);
__d("useRegisterMAWThreadEvent",["I64","Int64Hooks","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReady","MAWThreadEvent","Promise","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=a.authorityLevel,f=a.threadKey,g=a.threadType,h=d("I64").ge(e,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)),i=c("useReStore")();d("Int64Hooks").useEffectInt64(function(){d("LSMessagingThreadTypeUtil").isSecure(g)&&h&&c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(i,f,"useRegisterMAWThreadEvent",function(a,c,e){d("MAWThreadEvent").setThreadEventHandler(e);return b("Promise").resolve()}))},[f,g,h,i])}g["default"]=a}),98);
__d("MAWCreateOneToOneThreadWithStringFBID",["I64","MAWCreateOneToOneThread"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=d("I64").of_string(b);return d("MAWCreateOneToOneThread").call(a,b)}g.call=a}),98);
__d("MAWCreateOptimisticSecureMessage",["I64","LSAuthorityLevel","LSHotEmojiSize","LSIntEnum","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSMessageSendStatus","LSQuickReplyType","LSReplyMessageAttachmentType","LSReplyMessageStatus","MAWAdminMsg","MAWBridgeBuildMsg","MAWBumpThread","MAWDbMsg","MAWLocalizationType","MAWMsgReplySnippet","MessagingAttachmentType","OfflineThreadingId","QPLUserFlow","ReQL","asyncToGeneratorRuntime","cr:2472","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){if(e==null)return[void 0,void 0];var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(b,e.timestampMs,e.messageId)));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"get_reply_msg_end",{instanceKey:f});a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("attachments")).getKeyRange(b,e.messageId)));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"get_reply_attachment_end",{instanceKey:f});return[g,a]});return i.apply(this,arguments)}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.table("messages")).getKeyRange(b)));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"get_offline_threading_id_end",{instanceKey:e});if(a==null)return d("OfflineThreadingId").createOfflineThreadingID();b=d("MAWDbMsg").toMsgId(a.messageId);return b==null?d("OfflineThreadingId").createOfflineThreadingID():d("MAWDbMsg").getNextOptimisticId(b)});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(b)));return a==null?void 0:a.firstName});return l.apply(this,arguments)}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(b==null)return;a=(yield k(a,b.senderId));return(a=d("MAWMsgReplySnippet").buildLocalizedReplySnippet({isAuthorMe:!0,isDeletedMsg:b.replyStatus===c("LSReplyMessageStatus").DELETED,recipientName:a,replySenderIsMe:d("I64").equal(b.senderId,e)}))==null?void 0:a.toString()});return n.apply(this,arguments)}function o(a){if(a==null)return;var b=a.attachmentType;return d("I64").equal(b,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE))||d("I64").equal(b,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").STICKER))?a.previewUrl:void 0}function p(a){a=a!==void 0&&a.hotEmojiSize!=null&&d("I64").equal(a.hotEmojiSize,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").SMALL))?d("LSIntEnum").ofNumber(c("LSReplyMessageAttachmentType").STICKER):void 0;return a}function e(a,b,c,d,e,f,g,h,i,j,k,l){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i,j,k,l,n,q,r,s){var t=Date.now(),u=d("I64").of_float(t);q=q;r(q);r=(yield h(e,i,f,l));var v=r[0];r=r[1];n=(yield d("MAWBridgeBuildMsg").buildOptimisticMessage(a,e,g,q,i,v,u,n));a=(yield m(a,v,j));yield e.table("messages").add(babelHelpers["extends"]({},n,{authorityLevel:d("LSIntEnum").ofNumber(c("LSAuthorityLevel").OPTIMISTIC),displayedContentTypes:d("LSIntEnum").ofNumber(1),hasQuickReplies:!1,hotEmojiSize:k,isAdminMessage:!1,isCollapsed:!1,isUnsent:!1,messageId:q,offlineThreadingId:q,primarySortKey:u,quickReplyType:d("LSIntEnum").ofNumber(c("LSQuickReplyType").NONE),replyAttachmentType:p(v),replyMediaPreviewHeight:r==null?void 0:r.previewHeight,replyMediaPreviewWidth:r==null?void 0:r.previewWidth,replyMediaUrl:o(r),replyMediaUrlMimeType:r==null?void 0:r.playableUrlMimeType,replySnippet:a,replySourceId:f==null?void 0:f.messageId,replySourceType:f!=null?d("LSIntEnum").ofNumber(c("LSMessageReplySourceType").MESSAGE):void 0,replySourceTypeV2:f!=null?d("LSIntEnum").ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE):void 0,senderId:j,sendStatus:d("LSIntEnum").ofNumber(c("LSMessageSendStatus").SERVER_RECEIVED),sendStatusV2:d("LSIntEnum").ofNumber(2),textHasLinks:!1,threadKey:i,timestampMs:u,viewFlags:d("LSIntEnum").ofNumber(0)}));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"after_create_optimistic_message",{instanceKey:l});n=b("cr:2472")==null?g:b("cr:2472").unvault(g);v=k!=null&&d("I64").equal(k,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").SMALL))&&n==="\ud83d\udc4d"?"(Y)":g;s&&(yield d("MAWBumpThread").threadMutation(e,i,u,u,d("MAWAdminMsg").buildLocalizedString([v],[],d("MAWLocalizationType").CURRENT_USER_SEND_TEXT),j));return[q,t]});return q.apply(this,arguments)}g.getReply=h;g.getOfflineThreadingId=a;g.getOptimisticReplySnippet=m;g.getReplyMediaUrl=o;g.getReplyAttachmentType=p;g.createOptimisticMessageFromEB=e}),98);
__d("useMAWCreateOptimisticSecureMessage",["I64","LSAuthorityLevel","LSHotEmojiSize","LSIntEnum","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSMessageSendStatus","LSQuickReplyType","MAWAdminMsg","MAWBridgeBuildMsg","MAWBumpThread","MAWCreateOptimisticSecureMessage","MAWLocalizationType","MWPActor.react","QPLUserFlow","asyncToGeneratorRuntime","cr:2472","qpl","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("useReStore")(),e=d("MWPActor.react").useActor();return function(f,g,h,i,j,k,l){return a.runInTransaction(function(){var m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(m){var n=Date.now(),o=d("I64").of_float(n),p=(yield d("MAWCreateOptimisticSecureMessage").getOfflineThreadingId(m,h,j));l(p);var q=(yield d("MAWCreateOptimisticSecureMessage").getReply(m,h,f,j)),r=q[0];q=q[1];var s=(yield d("MAWBridgeBuildMsg").buildOptimisticMessage(a,m,g,p,h,r,o,k)),t=(yield d("MAWCreateOptimisticSecureMessage").getOptimisticReplySnippet(a,r,e));yield m.table("messages").add(babelHelpers["extends"]({},s,{authorityLevel:d("LSIntEnum").ofNumber(c("LSAuthorityLevel").OPTIMISTIC),displayedContentTypes:d("LSIntEnum").ofNumber(1),hasQuickReplies:!1,hotEmojiSize:i,isAdminMessage:!1,isCollapsed:!1,isUnsent:!1,messageId:p,offlineThreadingId:p,primarySortKey:o,quickReplyType:d("LSIntEnum").ofNumber(c("LSQuickReplyType").NONE),replyAttachmentType:d("MAWCreateOptimisticSecureMessage").getReplyAttachmentType(r),replyMediaPreviewHeight:q==null?void 0:q.previewHeight,replyMediaPreviewWidth:q==null?void 0:q.previewWidth,replyMediaUrl:d("MAWCreateOptimisticSecureMessage").getReplyMediaUrl(q),replyMediaUrlMimeType:q==null?void 0:q.playableUrlMimeType,replySnippet:t,replySourceId:f==null?void 0:f.messageId,replySourceType:f!=null?d("LSIntEnum").ofNumber(c("LSMessageReplySourceType").MESSAGE):void 0,replySourceTypeV2:f!=null?d("LSIntEnum").ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE):void 0,senderId:e,sendStatus:d("LSIntEnum").ofNumber(c("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:d("LSIntEnum").ofNumber(1),textHasLinks:!1,threadKey:h,timestampMs:o,viewFlags:d("LSIntEnum").ofNumber(0)}));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"after_create_optimistic_message",{instanceKey:j});s=b("cr:2472")==null?g:b("cr:2472").unvault(g);r=i!=null&&d("I64").equal(i,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").SMALL))&&s==="\ud83d\udc4d"?"(Y)":g;yield d("MAWBumpThread").threadMutation(m,h,o,o,d("MAWAdminMsg").buildLocalizedString([r],[],d("MAWLocalizationType").CURRENT_USER_SEND_TEXT),e);return[p,n]});return function(a){return m.apply(this,arguments)}}(),"readwrite","ui")}}g["default"]=a}),98);
__d("MAWSecureComposerText",["Lexical","LexicalText","MAWJids","MessengerLexicalEntityTextNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.read(function(){var a=d("Lexical").$getRoot().getFirstChild();return a instanceof d("Lexical").ElementNode?a.getChildren().reduce(function(a,b){if(d("MessengerLexicalEntityTextNode").isMessengerLexicalEntityTextNode(b)){var c=b.getEntity();return a+("@"+d("MAWJids").toUserJid(c.id))}return a+b.getTextContent()},""):d("LexicalText").$rootTextContent()})}g.getTextFromEditorState=a}),98);
__d("MAWSecureThreadNonAddressableContactBanner.bs",["fbt","CometPressable.react","I64","Int64Hooks","IntlVariations","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","LSWhatsAppConnectStatus","MDSRow.react","MDSRowItem.react","MWPActor.react","MWXText.react","ReQL.bs","ReQLSubscription.bs","fbs","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");b=d("react");var j=b.useCallback,k=b.useState;function l(a){a=a.onPress;return i.jsx("div",{className:"x1923su1 x10l6tqk xfr5jun x1vjfegm",children:i.jsx(c("CometPressable.react"),{"aria-label":c("fbs")._("__JHASH__cwU_O5_fD5E__JHASH__"),onPress:a,overlayRadius:"50%",children:i.jsxs("svg",{height:"18px",viewBox:"0 0 24 24",width:"18px",children:[i.jsx("title",{children:c("fbs")._("__JHASH__lJTlDYURTnq__JHASH__")}),i.jsx("line",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",x1:"6",x2:"18",y1:"6",y2:"18"}),i.jsx("line",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",x1:"6",x2:"18",y1:"18",y2:"6"})]})})})}l.displayName=l.name+" [from "+f.id+"]";function m(a){var b=c("useReStore")(),e=d("MWPActor.react").useActor(),f=d("ReQLSubscription.bs").useFirst(d("Int64Hooks").useMemoInt64(function(){return d("ReQL.bs").map(d("ReQL.bs").filter(d("ReQL.bs").mergeJoin(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(b.table("participants")),{hd:a,tl:0}),d("ReQL.bs").fromTableAscending(b.table("contacts"))),function(a){a=a[1];if(d("I64").equal(a.waConnectStatus,d("LSIntEnum").ofNumber(c("LSWhatsAppConnectStatus").WHATSAPP_NOT_ADDRESSABLE))&&d("I64").ge(a.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE_PENDING_REPLACEMENT)))return!d("I64").equal(a.id,e);else return!1}),function(a){return a[1]})},[b,a,e]),"lidon3i4"),g=(f==null?void 0:f.firstName)||(f==null?void 0:f.name)||"recipient";return[f!=null,g]}function a(a){var b=a.setHideComposerEditor;a=a.thread;var e=m(a.threadKey),f=e[0];e=e[1];var g=k(!1),n=g[0],o=g[1];g=j(function(){return o(!0)},[o]);var p=d("LSMessagingThreadTypeUtil").isGroup(a.threadType);n=p?!n:!0;var q=f&&n;b(function(){if(q)return!p;else return!1});f=c("IntlVariations").GENDER_UNKNOWN;n=h._("__JHASH__9vfr7-Uns9r__JHASH__",[h._name("message recipient name",e,f)]);b=h._("__JHASH__XH9tq8L7e1M__JHASH__",[h._name("message recipient name",e,f)]);if(q)return i.jsxs("div",{className:"xzg4506 x1n2onr6 x1ja2u2z",children:[p?i.jsx(l,{onPress:g}):null,i.jsx(c("MDSRow.react"),{align:"center",expanding:!0,paddingVertical:12,spacingVertical:0,children:i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MWXText.react"),{color:"primary",type:"headlineEmphasized4",children:d("LSMessagingThreadTypeUtil").isGroup(a.threadType)?c("fbs")._("__JHASH___yUMmqEez-U__JHASH__"):n})})}),i.jsx(c("MDSRow.react"),{align:"center",expanding:!0,paddingVertical:4,spacingVertical:4,children:i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:"body4",children:d("LSMessagingThreadTypeUtil").isGroup(a.threadType)?c("fbs")._("__JHASH__ixaC9ybh3Q8__JHASH__"):b})})})]});else return null}g.MAWSecureThreadNonAddressableContactBanner=a}),98);
__d("MAWSecureTypingState",["I64","Int64Hooks","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","MAWBridgeFireAndForget","MAWJids","MAWMiActOnActThreadReady","MWPActor.react","MessengerWebUXLogger","Promise","ReQL","WAChatState","asyncToGeneratorRuntime","gkx","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(!d("I64").equal(f,d("LSIntEnum").ofNumber(15)))return b("Promise").resolve(!0);f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("participants")).getKeyRange(e).filter(function(a){return!d("I64").equal(a.contactId,g)})));if(f==null)return!1;e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(f.contactId)));return e==null?!1:d("I64").equal(e.blockedByViewerStatus,d("LSIntEnum").ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED))});return i.apply(this,arguments)}var j=[];function a(a){var e=c("useReStore")(),f=d("MWPActor.react").useActor(),g=d("I64").to_string(a.threadKey),i=c("MessengerWebUXLogger")==null?void 0:c("MessengerWebUXLogger").useInteractionLogger();return d("Int64Hooks").useCallbackInt64(function(k){d("I64").ge(a.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))&&d("LSMessagingThreadTypeUtil").isSecure(a.threadType)&&(c("gkx")("5514")&&d("LSMessagingThreadTypeUtil").isGroup(a.threadType)&&!j.includes(g)&&c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(e,a.threadKey,"MAWSecureTypingState",function(a,c,e){d("MAWBridgeFireAndForget").fireAndForget("backend","preEstablishSession",{groupJid:d("MAWJids").toGroupJid(e)});j.push(g);return b("Promise").resolve()})),c("promiseDone")(h(e,a.threadKey,a.threadType,f).then(function(c){return!c?b("Promise").resolve():d("MAWMiActOnActThreadReady").onActThreadReady(e,a.threadKey,"MAWSecureTypingState",function(c,e,f){i==null?void 0:i({eventName:"send_typing_indicators",threadKey:a.threadKey,threadType:a.threadType});d("MAWBridgeFireAndForget").fireAndForget("backend","sendChatStateFromComposer",{state:k?d("WAChatState").TYPING:d("WAChatState").IDLE,threadId:e});return b("Promise").resolve()})})))},[e,a.authorityLevel,a.threadKey,a.threadType,f,g,i])}g.useOnTypingStateChanged=a}),98);
__d("MAWSecureComposer.react",["fbt","MAWEditMessageContext.react","MAWSecureComposerText","MAWSecureComposerUtils","MAWSecureThreadNonAddressableContactBanner.bs","MAWSecureTypingState","MWBlockedComposerLogging","MWMediaManager.bs","MWPComposerEditor.bs","MWPReplyContext.bs","MWV2ComposerReplyView.react","MWV2ComposerView.react","MWV2FileDropzone.react","WebUXLoggingSurfaceContextProvider","cr:5074","cr:6104","emptyFunction","qex","react","useCometAlertDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");e=d("react");var j=e.useCallback,k=e.useContext,l=e.useImperativeHandle,m=e.useState,n=(e=c("qex")._("670"))!=null?e:!1;function a(a){var e=a.afterSendMessage;e=e===void 0?c("emptyFunction"):e;var f=a.isPreviewThread,g=a.onSendEmptyMessage;g=g===void 0?c("emptyFunction"):g;var o=a.thread;a=k(d("MWPReplyContext.bs").context);a=a.reply;var p=k(d("MAWEditMessageContext.react").Context);p=p.isEdit;var q=c("useCometAlertDialog")(),r=j(function(){return q({body:h._("__JHASH__cHTRYg3bfeC__JHASH__"),title:h._("__JHASH__shIDOoHHO5L__JHASH__")})},[q]);r=d("MWMediaManager.bs").useMediaManager(o,r);var s=r.handleFileRemove,t=r.handleFileSelect,u=r.mediaStaging;r=r.resetAttachments;var v=b("cr:6104")(o,e,r);e=d("MAWSecureTypingState").useOnTypingStateChanged(o);r=k(d("MWV2FileDropzone.react").mWV2FileDropzoneContext);l(r,function(){return{enabled:!0,handler:t}},[t]);r=m(!1);var w=r[0];r=r[1];d("MWBlockedComposerLogging").useLogMWBlockedComposerReason(o,w?d("MWBlockedComposerLogging").ComposerBlockingReason.ARMADILLO_RECEIVER_NON_ADDRESSABLE_ON_WA:d("MWBlockedComposerLogging").ComposerBlockingReason.NOT_BLOCKED);return i.jsx(d("WebUXLoggingSurfaceContextProvider").WebUXLoggingSurfaceContextProvider,{value:"secure_composer",children:i.jsxs("div",{"data-testid":void 0,children:[a!=null?i.jsx(d("MWV2ComposerReplyView.react").MWV2ComposerReplyView,{messageId:a.messageId,messageTimestamp:a.timestampMs,thread:o}):null,p&&b("cr:5074")?i.jsx(b("cr:5074"),{}):null,i.jsx(d("MAWSecureThreadNonAddressableContactBanner.bs").MAWSecureThreadNonAddressableContactBanner,{setHideComposerEditor:r,thread:o}),w?null:i.jsx(d("MWPComposerEditor.bs").MWPComposerEditor,{getTextFromEditorState:d("MAWSecureComposerText").getTextFromEditorState,isPreviewThread:f,mediaStaging:u,onSendEmptyMessage:g,onSendMessage:v,onTypingStateChanged:e,thread:o,children:function(a,b,c,e){return i.jsx(d("MWV2ComposerView.react").MWV2ComposerView,{editor:a,editorElementRef:c,hasStuffToSend:b,isMentionsPluginEnabled:n,mediaStaging:u,onAttachmentRemoved:s,onAttachmentsAdded:t,onSendMessage:v,policyProduct:"messaging_lightswitch",sendMessage:e,supportedFileTypes:d("MAWSecureComposerUtils").supportedFileTypes,surface:"mwp_maw_secure_composer",thread:o})}})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWChatFile.react",["MAWFilePressable.react","MDSTextPairing.react","MWChatFilePreview.bs","MWInboxInfoSharedContentQPLLogger.bs","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={content:{color:"xzsf02u",flexGrow:"x1iyjqo2",fontWeight:"x1s688f",paddingTop:"xz9dl7a",paddingEnd:"xn6708d",paddingBottom:"xsag5q8",paddingStart:"x1ye3gou",wordBreak:"x13faqbe",$$css:!0},fileSize:{paddingTop:"x889kno",$$css:!0},root:{alignItems:"x6s0dn4",display:"x78zum5",userSelect:"x87ps6o",$$css:!0}};function j(){d("MWInboxInfoSharedContentQPLLogger.bs").logOpenSharedContentFromThread("files")}function a(a){var b=a.file;return h.jsx(c("MAWFilePressable.react"),{entrypoint:"chat_file_v4",file:b,onPress:j,testid:void 0,children:function(a){var d=a.filename;a=a.size;return h.jsxs("div",{className:c("stylex")(i.root,!1),children:[h.jsx(c("MWChatFilePreview.bs"),{attachment:b,withPreview:!1}),h.jsxs("div",{className:"xzsf02u x1iyjqo2 x1s688f xz9dl7a xn6708d xsag5q8 x1ye3gou x13faqbe",children:[h.jsx(c("MDSTextPairing.react"),{headline:d,headlineLineLimit:3,level:4}),h.jsx("div",{className:"x889kno",children:h.jsx(c("MDSTextPairing.react"),{body:a,bodyColor:"secondary",bodyLineLimit:1,level:4})})]})]})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWEncryptedBackupsIssueRangeQueryDeferred",["react","requireDeferred","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback,i=c("requireDeferred")("MWEncryptedBackupsIssueRangeQuery.bs").__setRef("useMWEncryptedBackupsIssueRangeQueryDeferred");function a(){var a=c("useReStore")();return h(function(b,c,d,e){i.onReady(function(f){return f.runQuery(a,b,c,d,e)})},[a])}g["default"]=a}),98);
__d("MAWForwardMessage",["MAWBridgeSendAndReceive","MAWCreateOneToOneThread","MAWGetEphemeralSettings","MAWJobDefinitions","MAWMiActOnActThreadReady","MAWThreadId","MAWTimedJob","MWThread_DEPRECATED.bs","WAJobOrchestratorTypes","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("MAWThreadId").isSecureThreadId(a,b)),f=!1;e||(yield d("MAWCreateOneToOneThread").call(a,b),f=!0);return d("MAWMiActOnActThreadReady").onActThreadReady(a,b,"MAWForwardMessage",function(a,b,d){return c(b,d,f)})});return i.apply(this,arguments)}function a(a,b,e,f,g){var i=d("MWThread_DEPRECATED.bs").toThreadKey(b);c("promiseDone")(h(a,i,function(a,b,c){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:e}).then(function(a){if(a!=null)return d("MAWGetEphemeralSettings").getEphemeralSetting(b,i).then(function(e){return d("MAWTimedJob").TimedUIJobStarters.waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.forwardMsg(b,a,(e=e)!=null?e:void 0,void 0,c,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},{s2sInstanceKey:g,source:f}))})})}))}g.maybeCreateNewThreadAndCallback=h;g.forwardMessage=a}),98);
__d("MAWForwardMessageFromSecureThread.react",["I64","LSFactory","LSHotEmojiSize","LSInsertNewMediaSend","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachments","LSMailboxType","LSMarkSubJobCompletedV2","LSOptimisticSendMessage","LSOptimisticSendXMAMessageForwardFromSecureThread","LSShape","LSVec","MAWBridgeSendAndReceive","MAWDbMedia","MAWDbXMA","MWChatThreadId","MWPComposerMediaUploadUtil","MWPOpenComposerUtils.bs","MWThread_DEPRECATED.bs","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","asyncToGeneratorRuntime","cr:2472","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return{action_url:void 0,attachment_fbid:b,attachment_index:d("I64").zero,attachment_type:a.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:a.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:b,original_file_hash:void 0,playable_duration_ms:a.playableDurationMs,playable_url:URL.createObjectURL(c),playable_url_mime_type:c.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,source_text:void 0,subtitle_text:void 0,title_text:void 0,xma_layout_type:void 0,xmas_template_type:void 0}}function i(a,b,c,e){var f;return{action_url:(f=b==null?void 0:b.actionUrl)!=null?f:b==null?void 0:b.nativeUrl,attachment_fbid:c,attachment_index:d("I64").zero,attachment_type:a.attachmentType,cta1_title:a.cta1Title,cta2_title:a.cta2Title,cta3_title:a.cta3Title,description_text:a.descriptionText,filename:a.filename,filesize:a.filesize,has_media:!1,has_xma:!0,image_url:void 0,mini_preview:void 0,offline_attachment_id:c,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:URL.createObjectURL(e),playable_url_mime_type:e.type,preview_height:void 0,preview_url:URL.createObjectURL(e),preview_url_mime_type:e.type,preview_width:void 0,source_text:a.sourceText,subtitle_text:a.subtitleText,title_text:a.titleText,xma_layout_type:a.xmaLayoutType,xmas_template_type:a.xmasTemplateType}}function j(a,e,f,g,h,i,j,k){k=c("LSFactory")(k);return c("LSOptimisticSendXMAMessageForwardFromSecureThread")(a,e,f,(a=g)!=null?a:void 0,h,j,c("LSVec").make([d("LSShape").ofRecord(i)]),k).then(function(){return b("Promise").resolve()})}function k(a,b){return a==null||b==null?void 0:{amplitudes:b.split(",").map(parseFloat),sampling_freq:a}}function l(a,e,f,g,h,i,j,l,m){var n=c("LSFactory")(l);return c("LSLocalApplyOptimisticMessageWithAttachments")(j,h,g,void 0,void 0,void 0,void 0,void 0,void 0,void 0,i,c("LSVec").make([d("LSShape").ofRecord(e)]),void 0,n).then(function(a){var c=a[0];a[1];return l.table("messages_optimistic_context").add({externalAttachmentUrl:void 0,initiatingSource:void 0,markThreadRead:!1,messageId:void 0,offlineThreadingId:c,platformRef:void 0,platformToken:void 0,replySourceId:void 0,replySourceType:void 0,sendType:void 0,skipUrlPreviewGen:void 0,taskId:d("I64").of_string(c),threadAttributionSource:m,threadKey:h}).then(function(){return b("Promise").resolve(c)})}).then(function(a){var f=e.attachment_fbid;return c("LSInsertNewMediaSend")(f,a,d("I64").zero,e.attachment_type,!1,!1,!1,!1,n).then(function(){return b("Promise").resolve([a,f])})}).then(function(g){var h=g[0],i=g[1];g=function(b,e){c("promiseDone")(a.runInTransaction(function(a){var b=c("LSFactory")(a);return c("LSMarkSubJobCompletedV2")(i,d("I64").of_float(e),void 0,void 0,void 0,b).then(function(){return d("MWPOpenComposerUtils.bs").resumeSendJob(b,h)})},"readwrite"))};d("MWPComposerMediaUploadUtil").startUpload(void 0,g,void 0,d("I64").equal(e.attachment_type,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO)),[f],[i],void 0,void 0,k(e.sampling_frequency_hz,e.waveform_data));return b("Promise").resolve()})}function a(a,b,c,d,e,f,g){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,m,n,o){var p=d("MWChatThreadId").getMessagingThreadType(e),q=d("MWThread_DEPRECATED.bs").toThreadKey(e);if(m!=null){var r=m.attachmentType;if(!(d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO))||d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE))||d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO))||d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE))||d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA))))throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_product");var s=null;if(!d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA))){s=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{mediaId:d("MAWDbMedia").convertNumberToMediaId(Number.parseInt(m.attachmentFbid,10))}));if(s==null)return}yield a.runInTransaction(function(e){switch(!0){case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO)):if(s==null)throw c("unrecoverableViolation")("Blob can not be null for MessagingAttachmentType.AUDIO","messenger_web_product");var t=new File([s],"mediaForwardedFromSecureThread",{type:s.type}),u=d("OfflineThreadingId").createOfflineThreadingID();u=d("MWPComposerMediaUploadUtil").getAudioAttachment(u,t,d("I64").to_int32((u=m.playableDurationMs)!=null?u:d("I64").zero)/1e3,k(m.samplingFrequencyHz!=null?d("I64").to_int32(m.samplingFrequencyHz):void 0,m.waveformData));return l(a,u,t,p,q,g,n,e,o);case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA)):return d("ReQL").firstAsync(d("ReQL").fromTableDescending(e.table("attachment_ctas")).getKeyRange((u=m.defaultCtaId)!=null?u:d("I64").zero)).then(function(a){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByXMAId",{infoType:"preview",xmaId:d("MAWDbXMA").convertNumberToXMAId(Number.parseInt(m.attachmentFbid,10))}).then(function(c){return b("Promise").resolve([a,c])})}).then(function(c){var h=c[0];c=c[1];if(c==null)return;c=new File([c],"xmaForwardedFromSecureThread",{type:c.type});var a=d("OfflineThreadingId").createOfflineThreadingID();h=i(m,h,a,c);a=f.text;c=b("cr:2472")==null||a==null?a:b("cr:2472").unvault(a);return j(n,q,p,c,g,h,o,e)});case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE)):case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE)):case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO)):case d("I64").equal(r,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)):if(s==null)throw c("unrecoverableViolation")("Blob can not be null for MessagingAttachmentType.AUDIO","messenger_web_product");u=new File([s],(t=m.filename)!=null?t:"mediaForwardedFromSecureThread",{type:s.type});t=d("OfflineThreadingId").createOfflineThreadingID();t=h(m,t,u);return l(a,t,u,p,q,g,n,e,o);default:throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_product")}},"readwrite")}else{e=f.text;if(e==null)throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_product");var t=b("cr:2472")==null?e:b("cr:2472").unvault(e),u=t==="\ud83d\udc4d"&&f.hotEmojiSize!=null&&d("I64").equal(f.hotEmojiSize,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").SMALL)),v=u?d("I64").of_string("369239263222822"):void 0;yield a.runInTransaction(function(a){return c("LSOptimisticSendMessage")(n,q,p,d("LSIntEnum").ofNumber(c("LSMailboxType").MESSENGER),u?void 0:t,void 0,void 0,v,void 0,void 0,void 0,o,void 0,void 0,void 0,void 0,void 0,g,void 0,void 0,!1,!1,void 0,void 0,void 0,void 0,void 0,c("LSFactory")(a))},"readwrite")}});return m.apply(this,arguments)}g.forwardMessage=a}),98);
__d("MAWInformTreatmentTypeTransform",["WAArmadilloXMA.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"MEDIA_LABEL":return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.MEDIA_LABEL;case"POST_COVER":return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.POST_COVER;case"POST_LABEL":return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.POST_LABEL;case"WARNING_SCREENS":return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.WARNING_SCREENS;default:return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE}}g["default"]=a}),98);
__d("MAWShareAttachment",["fbt","CometRelay","ConstUriUtils","FBLogger","I64","LSDatabaseSingleton","LSIntEnum","LSMessagingThreadAttributionType","MAWCreateOneToOneThreadWithStringFBID","MAWExternalId","MAWGetEphemeralSettings","MAWImagePreProcess","MAWInformTreatmentTypeTransform","MAWJids","MAWJobDefinitions","MAWMiActOnActThreadReady","MAWShareAttachment_LinkPreviewQuery.graphql","MAWTimedJob","MWQPLMarkers","Promise","QPLUserFlow","ReQL","ReQLSuspense","WAArmadilloXMA.pb","WAJids","WAJobOrchestratorTypes","asyncToGeneratorRuntime","err","qpl"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("LSDatabaseSingleton")),e=d("I64").of_string(a.targetID);return d("ReQLSuspense").toArray(d("ReQL").fromTableAscending(b.table("participants")).getKeyRange(e).filter(function(a){return!d("I64").equal(a.contactId,e)}).map(function(a){return d("MAWJids").toUserJid(d("I64").to_string(a.contactId))}),f.id+":74")});return k.apply(this,arguments)}function l(a){return!Boolean(a)?b("Promise").resolve():window.fetch(a).then(function(a){return a.blob()})["catch"](function(){c("FBLogger")("messenger_e2ee_web").mustfix("Error fetching url in xma share");return b("Promise").resolve()})}function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_FETCH_BEGIN);e=d("ConstUriUtils").getUri(e);if(e==null)return{};e=(e=e.setSubDomain("www"))==null?void 0:e.toString();if(e==null)return{};f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_QUERY_BEGIN);a=(yield d("CometRelay").fetchQuery(a,i!==void 0?i:i=b("MAWShareAttachment_LinkPreviewQuery.graphql"),{url:e}).toPromise()["catch"](function(a){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_QUERY_DATA_FOR_XMA_SHARE,{}),c("FBLogger")("messenger_e2ee_web").mustfix("Failed execute MAWShareAttachment_LinkPreviewQuery for MAWShareAttachent")}));f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_QUERY_COMPLETE);a=a==null?void 0:a.post_reshare_xma;if(a==null){f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.MISSING_XMA_DATA);return{}}if(a==="private"){var j=new Blob([],{type:"image/jpeg"});f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.RETURN_PRIVATE_XMA_DATA);return{defaultCTA:{actionUrl:e,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:e,title:h._("__JHASH__Xv8OyXI6-mU__JHASH__").toString()},overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE,preview_blob:j}}var k;try{k=JSON.parse(a)}catch(a){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_PARSE_JSON_FOR_XMA_SHARE,{});throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Failed to fetch blob xma data for MAWShareAttachent")}j=k;a=j.action_url;var m=j.ctas,n=j.default_cta_title,o=j.favicon_url,p=j.image_url,q=j.preview_url,r=j.subtitle_text;j=j.title_text;o=(yield b("Promise").all([o,p,q].map(function(a){return l(a)}))["catch"](function(a){f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_BLOB_FOR_XMA_SHARE);c("FBLogger")("messenger_e2ee_web").mustfix("Failed to fetch blob xma data for MAWShareAttachent");return[void 0,void 0,void 0]}));p=o[0];q=o[1];o=o[2];m=m;var s=m==null?void 0:m[0];a=(a=(a=a)!=null?a:s==null?void 0:s.action_url)!=null?a:e;e={actionUrl:a,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(e=s==null?void 0:s.native_url)!=null?e:a,title:(s=n)!=null?s:void 0};f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.RETURN_PUBLIC_XMA_DATA);return{ctas:m==null?void 0:m.map(function(a){var b;return{actionUrl:(b=a.action_url)!=null?b:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(b=a.native_url)!=null?b:void 0,title:(b=a.title)!=null?b:void 0}}),defaultCTA:e,favicon_blob:(a=p)!=null?a:void 0,image_blob:(n=q)!=null?n:void 0,preview_blob:(s=o)!=null?s:void 0,subtitle_text:(m=r)!=null?m:void 0,title_text:(e=j)!=null?e:void 0}});return n.apply(this,arguments)}function o(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,i,j,k,l,m,n,o,p,q){a!=null&&(e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FETCHING_DEVICES_FOR_XMA_SHARE),yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!1,reason:"send-share-attachment",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},users:new Set(a)})));a=(yield d("MAWGetEphemeralSettings").getEphemeralSetting(f,q));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.CREATED_THREAD_FOR_XMA_SHARE);return f!=null?d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendXMAShareMsg",{args:{ephemeralSetting:a==null?void 0:a,offlineAttachmentId:g.shareID,s2sInstanceKey:p,s2sUserFlowQPLEvent:c("qpl")._(25313175,"1551"),source:d("LSIntEnum").ofNumber((q=o)!=null?q:c("LSMessagingThreadAttributionType").UNKNOWN),xmaMessageType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},associatedMsgContent:(e=g.message)!=null?e:void 0,associatedMsgContentExternalId:g.message==null?void 0:d("MAWExternalId").generateExternalId(),chatJid:f,faviconFile:h,previewFile:i,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},xmaArgs:{ctas:j,defaultCTA:k,overlayIconGlyph:(a=l)!=null?a:c("MAWInformTreatmentTypeTransform")((p=g.messagingInformTreatmentInfo)==null?void 0:p.treatmentType),overlayTitle:(q=(o=g.messagingInformTreatmentInfo)==null?void 0:o.messagingInformTreatmentName)!=null?q:void 0,subtitleText:(e=m)!=null?e:void 0,titleText:(f=n)!=null?f:void 0},xmaMsgExternalId:d("MAWExternalId").generateExternalId()})):b("Promise").resolve()});return p.apply(this,arguments)}function a(a,b,c,d,e){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){if(e.url===null)return;var i=function(a){c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),a,{instanceKey:h})},k=function(a,b){b===void 0&&(b={}),c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),a,{annotations:b,instanceKey:h})};a=(yield m(a,(a=e.url)!=null?a:"",i,k));var l=a.ctas,n=a.defaultCTA,p=a.favicon_blob;a.image_blob;var q=a.overlayIconGlyph,r=a.preview_blob,s=a.subtitle_text,t=a.title_text;i(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_FETCH_SUCCESS);a=r==null?void 0:new File([r],"preview",{type:r.type});r=p==null?void 0:new File([p],"favicon",{type:p.type});p=q===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE?b("Promise").resolve({height:0,width:0}):a!=null?d("MAWImagePreProcess").getImageSpec(a):b("Promise").resolve();var u=r!=null?d("MAWImagePreProcess").getImageSpec(r):b("Promise").resolve();p=(yield b("Promise").all([p,u]));u=p[0];p=p[1];i(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.PREVIEW_FAVICON_SPEC_READY);var v=a==null||u==null?void 0:{file:a,height:u.height,width:u.width},w=r==null||p==null?void 0:{file:r,height:p.height,width:p.width};if(v==null){k(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.PREVIEW_DOES_NOT_EXIST);throw c("err")("Preview must exist in the XMA Send Path")}if(f!=null)if(f.isTargetE2E===!0){var x=d("I64").of_string_opt(e.targetID);if(x==null){k(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_CHAT_JID_FOR_XMA_SHARE);throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Failed to fetch threadKey for MAW XMA Attachment Share")}return c("LSDatabaseSingleton").then(function(a){return d("MAWMiActOnActThreadReady").onActThreadReady(a,x,"fetch-existing-chatJid",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,m){b=m;if(b==null){k(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_CHAT_JID_FOR_XMA_SHARE,{bool:{createNewThread:!1}});throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Failed to fetch chatJid for MAW XMA Attachment Share")}f!=null&&f.typeName==="User"?m=[d("MAWJids").toUserJid(e.targetID)]:m=(yield j(e));return o(m,i,b,e,w,v,l,n,q,s,t,g,h,a)});return function(b,c,d){return a.apply(this,arguments)}}())})}else if(f.targetType==="USER")return c("LSDatabaseSingleton").then(function(a){return d("MAWCreateOneToOneThreadWithStringFBID").call(a,f.targetID)}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a==null?void 0:a.jid;if(a==null){k(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_CHAT_JID_FOR_XMA_SHARE,{bool:{createNewThread:!0}});throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Failed to fetch chatJid for MAW XMA Attachment Share")}var b=[d("WAJids").interpretAsUserJid(a)].filter(Boolean);i(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FETCHING_DEVICES_FOR_XMA_SHARE);yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!1,reason:"send-share-attachment",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},users:new Set(b)}));return o(b,i,a,e,w,v,l,n,q,s,t,g,h)});return function(b){return a.apply(this,arguments)}}())});return q.apply(this,arguments)}g.fetchBlob=l;g.fetchXMAData=m;g.shareSecureAttachment=a}),98);
__d("MAWFowardMessageFromOpenThread",["I64","LSIntEnum","MAWExternalId","MAWForwardMessage","MAWGetEphemeralSettings","MAWImagePreProcess","MAWJobDefinitions","MAWSecureComposerUtils","MAWShareAttachment","MAWUIJob","MAWVideoUtils","MWThread_DEPRECATED.bs","MessagingAttachmentType","Promise","ReQL","WAArmadilloXMA.pb","WAJobOrchestratorTypes","asyncToGeneratorRuntime","gkx","promiseDone","qpl","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){return b("Promise").all([d("MAWImagePreProcess").getImageSpec(a),b("Promise").resolve(a),c.arrayBuffer(),d("MAWImagePreProcess").getImageSpec(c)]).then(function(a){var c=a[0],d=a[1],e=a[2];a=a[3];return b("Promise").resolve({args:{imageSpec:c,thumbnailUrlAndSpec:{duration:void 0,height:a.height,jpegThumbnail:e,width:a.width}},file:d,type:"image"})})}function i(a){return d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(a).then(function(c){return b("Promise").resolve({args:{thumbnailUrlAndSpec:c},file:a,type:"video"})})}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("MAWShareAttachment").fetchBlob(a));b=a==null?void 0:new File([a],b,{type:a.type});a=b!=null?yield d("MAWImagePreProcess").getImageSpec(b):null;return b!=null&&a!=null?{file:b,height:a.height,width:a.width}:void 0});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.table("attachment_ctas")).getKeyRange(a)));return c==null||b==null&&c.actionUrl==null?null:{actionUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,title:(c=b)!=null?c:void 0}});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=a.actionUrl,f=a.attachmentCta1Id,g=a.attachmentCta2Id,h=a.attachmentCta3Id,i=a.cta1Title,k=a.cta2Title,m=a.cta3Title,n=a.defaultCtaId,o=a.defaultCtaTitle,p=a.faviconUrl,q=a.headerImageUrl,r=a.headerTitle,s=a.maxSubtitleNumOfLines,t=a.maxTitleNumOfLines,u=a.previewUrl,v=a.subtitleText;a=a.titleText;p=(yield b("Promise").all([[p,"favicon"],[q,"headerImage"],[u,"preview"]].map(function(a){return j(a[0],a[1])})));q=p[0];u=p[1];p=p[2];var w;if(n!=null){n=(yield l(n,o,c));w=(n=n)!=null?n:{actionUrl:(n=e)!=null?n:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(n=e)!=null?n:void 0,title:(e=o)!=null?e:void 0}}n=[];if(f!=null){o=(yield l(f,i,c));o!=null&&n.push(o)}if(g!=null){e=(yield l(g,k,c));e!=null&&n.push(e)}if(h!=null){f=(yield l(h,m,c));f!=null&&n.push(f)}g={ctas:n,defaultCTA:w,headerTitle:r,maxSubtitleNumOfLines:d("I64").to_int32((i=s)!=null?i:d("I64").zero),maxTitleNumOfLines:d("I64").to_int32((o=t)!=null?o:d("I64").zero),overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,subtitleText:v,titleText:a};return{faviconFileArgs:q,headerFileArgs:u,previewFileArgs:p,xmaArgs:g}});return o.apply(this,arguments)}function p(a){var e=a.attachmentType,f=a.filename,g=a.playableDurationMs,j=a.playableUrl,k=a.playableUrlMimeType,l=a.previewUrl,m=a.previewUrlMimeType;if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE))||d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO))||d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE))){if(j==null)throw c("unrecoverableViolation")("If you see this error, there is no playableUrl for this attachment","messenger_web_product");var n=d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE));if(l!=null){a=n?l+"&":j;var o=n?l+"&":l;return b("Promise").all([window.fetch(a).then(function(a){return a.blob()}),window.fetch(o).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:n?m:k});a=new File([a],"previewForwardedFromOpenThread",{type:m});if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE)))return h(b,a);if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO)))return i(b);if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return h(b,a);throw c("unrecoverableViolation")("shouldn't have this error in forward message from open thread","messenger_web_product")})}a=n?j+"&":j;return window.fetch(a).then(function(a){return a.blob()}).then(function(a){if(n&&k==="video/mp4")throw c("unrecoverableViolation")("If you see this error, there is only mp4 url for gif","messenger_web_product");a=new File([a],(a=f)!=null?a:"mediaForwardedFromOpenThread",{type:k});if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE)))return d("MAWSecureComposerUtils").imagePreprocess(a,!1);if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO)))return i(a);if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE)))return d("MAWSecureComposerUtils").documentFilePreprocess(a);if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return b("Promise").all([d("MAWImagePreProcess").getJpegThumbnailInfo(a,400),d("MAWImagePreProcess").getImageSpec(a),b("Promise").resolve(a)]).then(function(a){var c=a[0],d=a[1];a=a[2];return b("Promise").resolve({args:{imageSpec:d,thumbnailUrlAndSpec:c},file:a,type:"image"})});throw c("unrecoverableViolation")("shouldn't have this error in forward message from open thread","messenger_web_product")})}if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO))){if(j!=null)return window.fetch(j+"&").then(function(a){return a.blob()}).then(function(a){var c;a=new File([a],"mediaForwardedFromOpenThread",{type:k});return b("Promise").resolve({args:{durations:d("I64").to_int32((c=g)!=null?c:d("I64").zero)/1e3,isPtt:!0},file:a,type:"audio"})});throw c("unrecoverableViolation")("If you see this error, there is no playableUrl for this audio attachment","messenger_web_product")}if(d("I64").equal(e,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").STICKER))){if(j==null&&l==null)throw c("unrecoverableViolation")("If you see this error, there is no url for this sticker","messenger_web_product");return j!=null?l!=null?b("Promise").all([window.fetch(j).then(function(a){return a.blob()}),window.fetch(l).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:k});a=new File([a],"previewForwardedFromOpenThread",{type:m});return h(b,a)}):window.fetch(j).then(function(a){return a.blob()}).then(function(a){a=new File([a],"mediaForwardedFromOpenThread",{type:k});return h(a,a)}):window.fetch(l).then(function(a){return a.blob()}).then(function(a){return d("MAWSecureComposerUtils").imagePreprocess(new File([a],"previewForwardedFromOpenThread",{type:m}),!0)})}throw c("unrecoverableViolation")("We do not support forwarding other media types","messenger_web_product")}function a(a,e,f,g,h,i,j,k){var l=d("MWThread_DEPRECATED.bs").toThreadKey(e);c("promiseDone")(d("MAWForwardMessage").maybeCreateNewThreadAndCallback(a,l,function(e,f,m){e=d("MAWGetEphemeralSettings").getEphemeralSetting(f,l);var o=m;return e.then(function(e){if(i!=null){if(i.attachmentFbid==="369239263222822"||i.attachmentFbid==="369239343222814"||i.attachmentFbid==="369239383222810"){var l;return d("MAWUIJob").UIJobStarters.waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendMsg",{args:{content:"\ud83d\udc4d",ephemeralSetting:(l=e)!=null?l:void 0,isFirstMsg:o,isForwarded:h,s2sInstanceKey:k,source:j,specialTextSize:1},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}))}return d("I64").equal(i.attachmentType,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA))?n(i,a).then(function(a){var b,g=a.faviconFileArgs,h=a.headerFileArgs,i=a.previewFileArgs;a=a.xmaArgs;return d("MAWUIJob").UIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendXMAShareMsg",{args:{ephemeralSetting:(b=e)!=null?b:void 0,isFirstMsg:o,isForwarded:!0,s2sInstanceKey:k,s2sUserFlowQPLEvent:c("qpl")._(25313175,"1551"),xmaMessageType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},chatJid:f,faviconFile:g,headerFile:h,previewFile:i,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},xmaArgs:a,xmaMsgExternalId:d("MAWExternalId").generateExternalId()}))}):p(i).then(function(a){switch(a.type){case"image":var g,i=a.args;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(g=e)!=null?g:void 0,height:i.imageSpec.height,isFirstMsg:o,isForwarded:h,jpegThumbnail:i.thumbnailUrlAndSpec.jpegThumbnail,jpegThumbnailHeight:i.thumbnailUrlAndSpec.height,jpegThumbnailWidth:i.thumbnailUrlAndSpec.width,s2sInstanceKey:k,source:j,width:i.imageSpec.width},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"video":g=a.args;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:g.thumbnailUrlAndSpec.duration,ephemeralSetting:(i=e)!=null?i:void 0,height:g.thumbnailUrlAndSpec.height,isFirstMsg:o,isForwarded:h,jpegThumbnail:g.thumbnailUrlAndSpec.jpegThumbnail,jpegThumbnailHeight:g.thumbnailUrlAndSpec.height,jpegThumbnailWidth:g.thumbnailUrlAndSpec.width,s2sInstanceKey:k,source:j,width:g.thumbnailUrlAndSpec.width},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"audio":i=a.args;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:Math.round(i.durations),ephemeralSetting:(g=e)!=null?g:void 0,isFirstMsg:o,isForwarded:h,isPtt:i.isPtt,s2sInstanceKey:k,source:j},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"document":if(c("gkx")("9045")){d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(g=e)!=null?g:void 0,filename:a.args.filename,isFirstMsg:o,isForwarded:h,s2sInstanceKey:k,source:j},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}))}else throw c("unrecoverableViolation")("Forwarding secure doc messages is not supported on web yet","messenger_web_product");break}return b("Promise").resolve()})}l=g.text;if(l!=null){return d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMsg",{args:{content:g.text,ephemeralSetting:(l=e)!=null?l:void 0,isFirstMsg:o,isForwarded:h,s2sInstanceKey:k,source:j},chatJid:f,externalId:d("MAWExternalId").generateExternalId(),scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}))}throw c("unrecoverableViolation")("We do not support forwarding this types","messenger_web_product")})}))}g.forwardMessage=a}),98);
__d("MWFailChatTabOpenQPLEvent",["MWGetChatTabOpenQPLEventTrace"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("MWGetChatTabOpenQPLEventTrace")(a,function(a){a.failTrace(b,!0)})}g["default"]=a}),98);
__d("useMAWThreadLastMessageConsistencyLogging",["CometDebounce","I64","Int64Hooks","MAWBridgeSendAndReceive","MAWLoadingStateOutstandingOfflineQueueSelector","MAWStateContext.react","logMessengerWebFalcoEvent","promiseDone","react","useMWEntrypoint","useReStore","useThreadLastMessageTimeMs"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useRef,i=c("CometDebounce")(c("logMessengerWebFalcoEvent"));function a(a){var b=a.thread;a=c("useReStore")();var e=h(!1),f=d("MAWStateContext.react").useMAWSelector(d("MAWLoadingStateOutstandingOfflineQueueSelector").outstandingOfflineQueueSelector),g=c("useMWEntrypoint")(),j=b.lastActivityTimestampMs,k=c("useThreadLastMessageTimeMs")(b.threadKey);d("Int64Hooks").useEffectInt64(function(){if(e.current)return;if(f)return;if(k==null)return;e.current=!0;var a=d("I64").compare(k,j)>-1,h={hasMissingMessage:!a,threadLastActivityTimeMs:d("I64").to_string(j),threadLastMessageTimeMs:d("I64").to_string(k)};c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","getThreadLastMessageTs",{threadKey:d("I64").to_string(b.threadKey)}),function(a){i({threadKey:b.threadKey,threadType:b.threadType},"thread_and_message_list_last_activity_mismatch",g,babelHelpers["extends"]({},h,{armadilloThreadLastMsgTs:(a=a==null?void 0:a.toString())!=null?a:""}))},function(){i({threadKey:b.threadKey,threadType:b.threadType},"thread_and_message_list_last_activity_mismatch",g,h)})},[a,g,e,f,b.threadKey,b.threadType,j,k])}g["default"]=a}),98);
__d("MWMessageElementRefList.bs",[],(function(a,b,c,d,e,f){"use strict";function a(){var a=new Map(),b=new Map(),c={contents:void 0};return{get:function(b,d){var e=a.get(b);if(e==null){c.contents=[b,d];return}else return d(e)},set:function(d){var e=b.get(d);if(!(e==null))return e;e=function(b){if(b==null){a["delete"](d);return}a.set(d,b);var e=c.contents;if(e!=null&&e[0]===d){e[1](b);c.contents=void 0;return}};b.set(d,e);return e}}}f.make=a}),66);
__d("isEventSupported",["fbjs/lib/ExecutionEnvironment"],(function(a,b,c,d,e,f){"use strict";var g;b("fbjs/lib/ExecutionEnvironment").canUseDOM&&(g=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function a(a,c){if(!b("fbjs/lib/ExecutionEnvironment").canUseDOM||c&&!("addEventListener"in document))return!1;c="on"+a;var d=c in document;if(!d){var e=document.createElement("div");e.setAttribute(c,"return;");d=typeof e[c]==="function"}!d&&g&&a==="wheel"&&(d=document.implementation.hasFeature("Events.wheel","3.0"));return d}e.exports=a}),null);
__d("MWChatConversationScroller.bs",["BaseScrollableAreaContext","CometThrottle","ExecutionEnvironment","isEventSupported","react","useLayoutEffect_SAFE_FOR_SSR"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");e=b.forwardRef;var i=b.useCallback,j=b.useContext,k=b.useEffect,l=b.useImperativeHandle,m=b.useLayoutEffect,n=b.useMemo,o=b.useRef;function p(a,b){a=a!=null?a:20;if(b==null)return!1;else return b.scrollTop+b.clientHeight>=b.scrollHeight-a}function q(a,b){a=a!=null?a:20;if(b==null)return!1;else return b.scrollTop<=a}var r=c("ExecutionEnvironment").canUseDOM?document.body.style.overscrollBehavior==null&&((d=document.body)==null?void 0:d.style.scrollBoundaryBehavior)==null:!1;function a(a,b){var d=a.boundingClientRectRef,e=a.children,f=a.dispatch,g=a.hasMoreAfter,s=a.scrollPositionRef;a=a.onScroll;var t=a!=null?a:function(a){},u=o(f),v=o(null),w=i(function(a){v.current=a;if(d!=null){d.current=a!=null?a.getBoundingClientRect():void 0;return}},[d]);k(function(){u.current=f});var x=function(a,b){b=v.current;if(b!=null){b.scrollTop=a;return}},y=function(a){a===void 0&&(a=!1);var b=v.current;if(b!=null)return x(b.scrollHeight,a)},z=function(a,b){var c=v.current;if(c!=null)return x(c.scrollHeight-(a+c.clientHeight),b)},A=o(!1);A.current=g;var B=function(){var a=s.current,b=v.current;b=b!=null?b.scrollHeight-(b.scrollTop+b.clientHeight):void 0;var c=p(void 0,v.current),d=q(void 0,v.current);s.current=c?A.current?{_0:void 0,TAG:3}:{_0:void 0,TAG:0}:b!=null?d?{_0:b,TAG:1}:{_0:b,TAG:2}:{_0:void 0,TAG:0};c=s.current;d=0;var e=0;switch(a.TAG){case 0:d=1;break;case 1:case 2:e=2;break;case 3:break}if(e===2)switch(c.TAG){case 1:d=1;break;case 2:break;case 0:case 3:u.current({_0:void 0,TAG:1});break}if(d===1){e=0;switch(a.TAG){case 1:break;case 0:case 2:e=2;break}e===2&&c.TAG===1&&u.current({_0:void 0,TAG:2})}return t(b)},C=function(a){if(r){var b=a.deltaY>0,c=a.deltaY<0;(b&&p(0,v.current)||c&&q(0,v.current))&&a.preventDefault()}return B()},D=function(a){var b=c("isEventSupported")("mousewheel")?"mousewheel":c("isEventSupported")("wheel")?"wheel":"DOMMouseScroll",d=function(b,c){a.addEventListener(b,c,{passive:!0});return function(){return a.removeEventListener(b,c,{passive:!0})}},e=function(){return a.addEventListener(b,C,{passive:!r})},f=function(){return a.removeEventListener(b,C,{passive:!r})},g=d("mouseenter",e),h=d("mouseleave",f);e=c("CometThrottle")(B,50,{trailing:!0});var i=d("scroll",e),j=d("mouseup",B),k=d("mousedown",B);return function(){f();i();g();h();k();return j()}};k(function(){var a=v.current;if(a==null)return;var b=D(a);return function(){return b()}},[]);m(function(){var a=v.current;!(a==null)&&a.clientHeight>0&&Math.abs(a.clientHeight-a.scrollHeight)<20&&u.current({_0:void 0,TAG:0})});c("useLayoutEffect_SAFE_FOR_SSR")(function(){var a=s.current;switch(a.TAG){case 0:y();break;case 1:z(a._0,!1);break;case 2:case 3:break}});c("useLayoutEffect_SAFE_FOR_SSR")(function(){var a=s.current;switch(a.TAG){case 0:y();break;case 1:case 2:z(a._0,!1);break;case 3:break}},[]);var E=j(c("BaseScrollableAreaContext")),F=n(function(){return{getDOMNode:function(){return v.current}}},[]);a=n(function(){return E.concat([F])},[F,E]);l(b,function(){return{getScroller:function(){return w},isContainerFilled:function(){var a=v.current;if(a==null)return!0;else return!(a.clientHeight>0&&Math.abs(a.clientHeight-a.scrollHeight)<20)},scrollElementIntoViewIfNeeded:function(a){var b=v.current;if(b==null)return;var c=a.getBoundingClientRect();b=b.getBoundingClientRect();c=c.top;b=b.top;if(c<=b){a.scrollIntoView();return}},scrollToBottom:function(){s.current={_0:void 0,TAG:0};return y()},scrollToElement:function(a,b){var c=v.current;if(c==null)return;a.scrollIntoView();a=a.getBoundingClientRect();var d=c.getBoundingClientRect();a=a.top;d=d.top;if(a<=d){c.scrollBy(0,-b|0);return B()}}}},[]);return h.jsx(c("BaseScrollableAreaContext").Provider,{children:h.jsx("div",{className:"x78zum5 xdt5ytf x1iyjqo2 x6ikm8r x1odjw0f xish69e x16qrkmw","data-release-focus-from":"CLICK",ref:w,tabIndex:-1,children:e}),value:a})}a.displayName=a.name+" [from "+f.id+"]";b=e(a);g.make=b}),98);
__d("MWV2MessageScroller.bs",["LSIntEnum","LSMailboxMessagesRangeQueryDirection","MWChatConversationScroller.bs","react","useMWMarkThreadAsReadWhenNewMessagesArrive"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useCallback;function a(a){var b=a.markThreadAsRead,e=a.lastMessageToCalculateIfThreadIsRead,f=a.children,g=a.fetchMore,j=a.hasMoreAfter,k=a.hasMoreBefore,l=a.scrollerRefs,m=a.thread;a=a.onScroll;a=a!=null?a:function(){};var n=i(function(){var a;return((a=l.scrollPositionRef.current)==null?void 0:a._0)===void 0&&((a=l.scrollPositionRef.current)==null?void 0:a.TAG)===0},[l]),o=i(function(){return!1}),p=c("useMWMarkThreadAsReadWhenNewMessagesArrive")(m,e,b,n,o);return h.jsx(d("MWChatConversationScroller.bs").make,{dispatch:function(a){switch(a.TAG){case 0:if(k)return g(d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").BEFORE));else return;case 1:if(j)return g(d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").AFTER));else return p();case 2:return g(d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").BEFORE))}},hasMoreAfter:j,onScroll:a,ref:l.scrollerRef,scrollPositionRef:l.scrollPositionRef,children:f})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWOptimisticCreateOrDeleteReaction",["I64","LSAuthorityLevel","MAWTimeUtils","QPLUserFlow","ReQL","WATimeUtils","asyncToGeneratorRuntime","err","qpl","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback;function a(){return h(function(a,e,f,g,h,i){return h.runInTransaction(function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){try{if(f==null){var h=(yield b.table("reactions").get(d("ReQL").key(a,e,i)));yield b.table("reactions")["delete"](d("ReQL").key(a,e,i));return h}else{yield b.table("reactions").upsert(d("ReQL").key(a,e,i),{actorId:i,authorityLevel:d("I64").of_int32(c("LSAuthorityLevel").OPTIMISTIC),messageId:e,reaction:(h=f)!=null?h:"",threadKey:a,timestampMs:d("MAWTimeUtils").toTimestamp(d("WATimeUtils").unixTime())})}}catch(a){c("QPLUserFlow").addPoint(c("qpl")._(1056843664,"1465"),"fail_create_optimistic_reaction",{instanceKey:g});throw c("err")("Failed to send or unsend optimistic reaction: "+a+" ")}finally{c("QPLUserFlow").addPoint(c("qpl")._(1056843664,"1465"),"create_optimistic_reaction_end",{instanceKey:g})}});return function(a){return h.apply(this,arguments)}}(),"readwrite")},[])}g["default"]=a}),98);
__d("MAWSendOrRemoveReaction.react",["FBLogger","I64","Int64Hooks","LSAuthorityLevel","MAWBridgeSendAndReceive","MAWBridgeUIEventQPLLogger","MAWDbMsg","MAWJobDefinitions","MAWMiActOnActThreadReady","MAWOptimisticCreateOrDeleteReaction","MAWTimedJob","MWLSDefaultThreadSource","MWPActor.react","QPLUserFlow","ReQL","WAJobOrchestratorTypes","err","promiseDone","qpl","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=d("MAWBridgeUIEventQPLLogger").getInstanceKey(),f=d("MWPActor.react").useActor(),g=c("useReStore")(),i=c("MAWOptimisticCreateOrDeleteReaction")(),j=d("MWLSDefaultThreadSource").useHook();return d("Int64Hooks").useCallbackInt64(function(k,l){var m=d("MAWDbMsg").toMsgId(k);if(b==null||m==null)return;c("QPLUserFlow").start(c("qpl")._(1056843664,"1465"),{instanceKey:e});c("QPLUserFlow").addPoint(c("qpl")._(1056843664,"1465"),"create_optimistic_reaction_start",{instanceKey:e});var n=j(a),o=i(a,m,l,e,g,f);c("promiseDone")(o);c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(g,a,"MAWSendOrRemoveReaction.react",function(i,j,k){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:m}).then(function(a){if(a!=null)return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.sendReactionMsg(k,a,b,l,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},n))}).then(function(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056843664,"1465"),{instanceKey:e})})["catch"](function(b){c("promiseDone")(h(g,a,m,l,f,o));c("FBLogger")("messenger_e2ee_web").catching(b).mustfix("Failed to send or unsend optimistic reaction: %s.",b);c("QPLUserFlow").endFailure(c("qpl")._(1056843664,"1465"),"failure",{instanceKey:e});throw c("err")("Failed to send or unsend optimistic reaction: "+b+" ")})}))},[b,e,j,a,i,g,f])}function h(a,b,e,f,g,h){return a.runInTransaction(function(i){if(f==null)return h.then(function(a){if(a==null)throw c("err")("User tries to remove a reaction that does not exist in LSDB. ");c("promiseDone")(i.table("reactions").upsert(d("ReQL").key(a.threadKey,a.messageId,a.actorId),babelHelpers["extends"]({},a)))});var j=d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("reactions")).getKeyRange(b,e,g).filter(function(a){return d("I64").equal(a.authorityLevel,d("I64").of_int32(c("LSAuthorityLevel").OPTIMISTIC))}));return j.then(function(a){if(a==null)return;return i.table("reactions")["delete"](d("ReQL").key(a.threadKey,a.messageId,a.actorId))})},"readwrite")}g.useSendOrRemoveReaction=a}),98);
__d("useMWV2ConversationScrollerRefs",["react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useMemo,i=b.useRef;function a(){var a=i(null),b=i({_0:void 0,TAG:0});return h(function(){return{scrollerRef:a,scrollPositionRef:b}},[])}g["default"]=a}),98);
__d("MWChatLoadMoreItemsIncrementally.bs",["I64","LSIntEnum","LSMailboxMessagesRangeQueryDirection","bs_belt_Array","react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useMemo,j=b.useRef,k=b.useState,l={contents:void 0};function m(){var a;l.contents==null&&(l.contents=window.document.documentElement.style.overflowAnchor!=null);return(a=l.contents)!=null?a:!1}function a(a,b,e,f,g,l){a=a!=null?a:!1;var n=b!=null?b:!0;b=e!=null?e:{_0:void 0,TAG:0};e=a||!m();var o=f.length,p;switch(b.TAG){case 1:case 2:p=b._0>=200;break;case 0:case 3:p=!1;break}a=k(function(){if(p)return o;else if(n)if(window.screen.availHeight<1200)return 20;else return 40;else return 10});var q=a[0],r=a[1];b=i(function(){return c("bs_belt_Array").sliceToEnd(f,-q|0)},[f,q]);var s=j(q);a=h(function(a){d("I64").equal(a,d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").BEFORE))||c("unrecoverableViolation")("Message fetch direction must be 'before'","messenger_web_product");if((s.current+15|0)<=o){s.current=s.current+15|0;return r(function(){return s.current})}else{g(d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").BEFORE));if(s.current<(o+15|0)){s.current=o+15|0;return r(function(){return s.current})}else return}},[g,o,r]);if(e)return[f,g,l];else return[b,a,l||q<o]}g.useLoadMore=a}),98);
__d("MAWSendFileMsgIfNecessary",["MAWSecureComposerUtils","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d,e,f,g,i,j,k,l,m,n){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,h,i,j,k,l,m,n,o){var p=[];if(f!=null){f={args:{durations:f.duration||0,isPtt:!0},file:f.file,type:"audio"};p.push([f,n])}if(h!=null){f=(yield window.fetch(h,{cache:"no-cache"}));h=(yield f.blob());f=i!=null;i=(yield d("MAWSecureComposerUtils").imagePreprocess(new File([h],"stickerFromPicker",{type:h.type}),f));p.push([i,n])}p=p.concat(g);h=p.map(function(b){var f=b[0];b=b[1];return d("MAWSecureComposerUtils").sendAttachment(a,c,j.threadKey,j.threadType,k,f,b,l,m,!1,e,o)});yield b("Promise").all(h)});return h.apply(this,arguments)}g.call=a}),98);
__d("useMAWFetchAndDispatchEphemeralSettings",["I64","MAWGetEphemeralSettings","MAWMiActOnActThreadReady","MAWStateContext.react","Promise","WALoggerDeferred","WATimeUtils","asyncToGeneratorRuntime","gkx","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ephemeral settings in memory]: MAWGetEphemeralSettings for "," returns ",", set it to 0"]);h=function(){return a};return a}e=d("react");var i=e.useCallback,j=e.useContext;function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("MAWGetEphemeralSettings").getEphemeralSetting(a,b));if(b!=null&&b.ephemeralExpirationInSec!=null&&b.ephemeralLastUpdatedOrSetTimestamp!=null)c(a,b);else{void d("WALoggerDeferred").LOG(h(),a,b);var e=d("WATimeUtils").unixTime();c(a,{ephemeralExpirationInSec:b==null?0:(c=b.ephemeralExpirationInSec)!=null?c:0,ephemeralLastUpdatedOrSetTimestamp:e})}});return l.apply(this,arguments)}function a(){var a=c("useReStore")(),e=j(d("MAWStateContext.react").MAWNonRerenderingStateContext),f=d("MAWStateContext.react").useDispatchEphemeralSettingsUpdatedForUI();return i(function(g){if(!c("gkx")("9025")){var h=e().state.ephemeralSettings;c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a,d("I64").of_string(g),"fetch-ephemeral-settings",function(a,c,e){return h[e]!=null?b("Promise").resolve():k(e,d("I64").of_string(g),f)}))}},[a,f,e])}g["default"]=a}),98);
__d("useMAWSendMessageV2",["I64","LSHotEmojiSize","LSIntEnum","MAWExternalId","MAWJobDefinitions","MAWTimedJob","MWPActor.react","MWPReplyContext.bs","QPLUserFlow","WADualSendMsgUtils","WAJobOrchestratorTypes","asyncToGeneratorRuntime","qpl","react","requireDeferred","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useContext,i=c("requireDeferred")("MWLogSend.bs").__setRef("useMAWSendMessageV2");function j(a){if(a==null)return;if(d("I64").equal(a,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").SMALL)))return 1;if(d("I64").equal(a,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").MEDIUM)))return 2;if(d("I64").equal(a,d("LSIntEnum").ofNumber(c("LSHotEmojiSize").LARGE)))return 3}function a(){var a=c("useReStore")(),e=d("MWPActor.react").useActor(),f=h(d("MWPReplyContext.bs").context),g=f.reply;return function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f,h,k,l,m,n,o,p,q,r,s,t,u,v,w,x){var y=d("MAWExternalId").generateExternalId();f=babelHelpers["extends"]({content:l,isFirstMsg:r,isForwarded:!1,openMessageOtid:n,openMessageParticipantCount:s,optimisticMsg:{msgId:o,ts:p},participantCount:t,s2sInstanceKey:x,s2sUserFlowQPLEvent:c("qpl")._(25313175,"1551"),source:m,specialTextSize:j(q)},u!=null&&{quote:u});v!=null&&(f.ephemeralSetting=v);w!=null&&(f.mentionedJids=[].concat(w));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"sending_message_to_wajob",{instanceKey:x});yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendMsg",{args:f,chatJid:k,externalId:y,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));i.onReady(function(c){var f=d("I64").to_string(b),i=q!=null?3:0,j=d("WADualSendMsgUtils").isDualSendJid(k)?["dst:8"]:void 0;return c.log(a,b,h,y,[],e,m,i,g!=null,0,1,f,v==null?void 0:v.ephemeralExpirationInSec,j,void 0,w)})});return function(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){return f.apply(this,arguments)}}()}g["default"]=a}),98);
__d("useMAWUpdateThreadCapabilities",["LSMessagingThreadTypeUtil","MAWUpdateLSThreadCapabilities","Promise","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback;function a(){var a=c("useReStore")();return h(function(c){return!d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType)?b("Promise").resolve():a.runInTransaction(function(a){return d("MAWUpdateLSThreadCapabilities").updateNonMessageRequestThreadTxn(a,c)},"readwrite")},[a])}g["default"]=a}),98);
__d("useMarkOptimisticMessageAsFailed",["LSFactory","LSMarkOptimisticMessageFailed","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback;function a(){var a=c("useReStore")();return h(function(b){return a.runInTransaction(function(a){return c("LSMarkOptimisticMessageFailed")(b,c("LSFactory")(a))},"readwrite")},[a])}g["default"]=a}),98);
__d("MAWSendSecureMessageV2.bs",["FBLogger","I64","Int64Hooks","LSIntEnum","LSMessagingInitiatingSourceHook.bs","LSMessagingThreadTypeUtil","MAWBridgeSendAndReceive","MAWDbMsg","MAWExternalId","MAWInternalLog","MAWJids","MAWMediaManagerUtils","MAWMiActMaybeCreateActThread","MAWOptimisticUpdateContactRelationship.bs","MAWSendFileMsgIfNecessary","MAWStateContext.react","MAWVault","MWChatInteraction.bs","MWLSDefaultThreadSource","MWLSLogSend.bs","MWMediaManager.bs","MWPActor.react","MWPReplyContext.bs","MWQPLMarkers","MWSharedMsgLogUtils","MWVersion.bs","MessageRequestsLog","Promise","Random","ReQL.bs","ReQLSubscription.bs","StickerConstants","WALoggerDeferred","WAStanzaUtils","asyncToGeneratorRuntime","cr:4584","emptyFunction","gkx","promiseDone","qpl","react","unrecoverableViolation","useCometInteractionTracing","useMAWCreateOptimisticSecureMessage","useMAWFetchAndDispatchEphemeralSettings","useMAWSendMessageV2","useMAWUpdateThreadCapabilities","useMWLSUnarchiveThread","useMWLSUpdateDraftMessage","useMarkOptimisticMessageAsFailed","useReStore"],(function(a,b,c,d,e,f,g){"use strict";e=d("react");var h=e.useContext,i=e.useMemo,j=["MAWSendSecureMessageV2","Composer"];function a(a,e,f){var g=c("useReStore")(),k=d("MWPActor.react").useActor(),l=h(d("MAWStateContext.react").MAWNonRerenderingStateContext),m=d("MAWStateContext.react").useDispatchOptimisticSendMessage(),n=c("useMAWCreateOptimisticSecureMessage")(),o=c("useMAWSendMessageV2")(),p=h(d("MWPReplyContext.bs").context),q=p.clearReply,r=p.reply,s=d("MWLSDefaultThreadSource").useHook();p=d("MWMediaManager.bs").useMediaManager(a);var t=p.mediaStaging,u=d("LSMessagingThreadTypeUtil").isMessageRequest(a),v=d("ReQLSubscription.bs").useArray(i(function(){return d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(g.table("participants")),{hd:a.threadKey,tl:0})},[a,g]),"ttkh523i").map(function(a){return d("I64").to_string(a.contactId)}),w=d("LSMessagingInitiatingSourceHook.bs").useHook(),x=c("useCometInteractionTracing")(c("qpl")._(30605384,"573"),"fast","INTERACTION",void 0),y=c("useCometInteractionTracing")(c("qpl")._(25313175,"1551"),"fast","INTERACTION",void 0),z=c("useMWLSUnarchiveThread")(),A=c("useMWLSUpdateDraftMessage")(),B=c("useMAWUpdateThreadCapabilities")(),C=c("useMarkOptimisticMessageAsFailed")(),D=c("useMAWFetchAndDispatchEphemeralSettings")();d("Int64Hooks").useEffectInt64(function(){D(d("I64").to_string(a.threadKey))},[D,a.threadKey]);return function(h,i,p,E,F,G,H,I,J,K,L){var M=p!=null&&d("I64").to_string(p)===c("StickerConstants").HOT_LIKE_SMALL_STICKER_ID?"\ud83d\udc4d":h;d("MAWInternalLog").internalLog("start to send message from UI");c("promiseDone")(d("WALoggerDeferred").logWithTags(j,["Starting message send"],"LOG"));x(function(h){y(function(x){var y=Date.now()+(Math.round(d("Random").random()*1e4)+1e4),F=Date.now(),H=t.reduce(function(a,b){var c=d("MAWMediaManagerUtils").MAWMediaManagerAttachments.get(b.offlineAttachmentId);c!=null&&a.push([c,d("WAStanzaUtils").toStanzaId(b.offlineAttachmentId)]);return a},[]),J=d("MWSharedMsgLogUtils").getMessageTypeParams(M,E,r,p,G,I,t);[h,x].forEach(function(b){d("MWSharedMsgLogUtils").addSharedMetadataForInteractionTrace(b,J,a,w)});var K=null,L=J.hasAttachment,N=J.hasFile,O=J.hasImage,P=J.hasVideo;L&&(P||O||N&&c("gkx")("9045")?K=d("WAStanzaUtils").toStanzaId(H[H.length-1][1]):K=d("MAWExternalId").generateExternalId());K!=null&&(d("MWLSLogSend.bs").logSentHeroInteraction(h,K,{initiatingSource:w,isDualSend:!1,isMessageRequest:u,mwVersion:d("MWVersion.bs").v2,threadType:a.threadType}),d("MWLSLogSend.bs").logSentHeroInteraction(x,d("MWChatInteraction.bs").s2sKey(K),{initiatingSource:w,isDualSend:!1,isMessageRequest:u,mwVersion:d("MWVersion.bs").v2,threadType:a.threadType}));q(a.threadKey,!1);f();var Q=null,R=null;if(M!=null&&b("cr:4584")!=null){P=b("cr:4584").findFirstUrl(M);R=P==null?null:P[0];Q=b("cr:4584").findFirstAvailableOembedUrlAndRequestPair(P)}var S=i==null?void 0:i.map(function(a){return d("MAWJids").toUserJid(a.id)});O=M!=null&&R==null?n(r,d("MAWVault").vault(M),a.threadKey,E,y,S,function(b){L||(d("MWLSLogSend.bs").logSentHeroInteraction(h,b,{initiatingSource:w,isDualSend:!1,isMessageRequest:u,mwVersion:d("MWVersion.bs").v2,threadType:a.threadType}),d("MWLSLogSend.bs").logSentHeroInteraction(x,d("MWChatInteraction.bs").s2sKey(b),{initiatingSource:w,isDualSend:!1,isMessageRequest:u,mwVersion:d("MWVersion.bs").v2,threadType:a.threadType}))}):b("Promise").resolve([void 0,void 0]);var T=s(a.threadKey);x.addMarkerPoint(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.BEFORE_CREATE_OPTIMISTIC_MESSAGE,"AppTiming");c("promiseDone")(A(a.threadKey,""));c("promiseDone")(O.then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){var h=f[0];f=f[1];x.addMarkerPoint(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.CREATE_OPTIMISTIC_MESSAGE_SUCCESS,"AppTiming");var i=(yield c("MAWMiActMaybeCreateActThread")(g,a.threadKey,{actorId:k,participantIds:v})),n=l().state.ephemeralSettings[i.jid];n==null&&(n=(yield D(d("I64").to_string(a.threadKey))));try{if(b("cr:4584")!=null&&R!=null){var q=R.entity.url,s=null;try{Q!=null&&(q=Q.oEmbedUrl,s=(yield b("cr:4584").getOembedResponse(Q.oEmbedRequest)))}catch(a){c("FBLogger")("messenger_e2ee_web").mustfix("[external link] Failed to fetch oEmbed response ")}finally{x.addMarkerPoint("get_external_link_response_success","AppTiming")}try{var t;yield b("cr:4584").sendExternalLinkXMA((t=M)!=null?t:"",s,q,i.jid,x.getInstanceKey(),T,a.threadKey,K)}catch(a){c("FBLogger")("messenger_e2ee_web").mustfix("[external link] Failed to send External Link XMA. ")}}else if(M!=null&&h!=null){m(h,F);if(f!=null){d("MAWInternalLog").internalLog("start to send message from backend");c("promiseDone")(d("WALoggerDeferred").logWithTags(j,["Starting message send from backend"],"LOG"));t=null;if(r!=null){s=d("MAWDbMsg").toMsgId(r.messageId);s!=null&&(t=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:s})))}yield o(a.threadKey,i.chatId,a.threadType,i.jid,M,T,void 0,h,f,E,i.created,void 0,void 0,t,n,S,x.getInstanceKey())}}K!=null&&(yield d("MAWSendFileMsgIfNecessary").call(g,i.chatId,i.created,I,H,G,p,a,k,T,r,K,x.getInstanceKey()));d("MAWInternalLog").internalLog("send message is done");c("promiseDone")(d("WALoggerDeferred").logWithTags(j,["Send message is done"],"LOG"));u&&d("MessageRequestsLog").logActionConfirmed(a,1);d("MAWOptimisticUpdateContactRelationship.bs").call(a,g,k);c("promiseDone")(B(a));q=d("I64").equal(a.parentThreadKey,d("LSIntEnum").ofNumber(-10));q&&z(a.threadKey);e()}catch(a){h!=null&&f!=null&&(d("MAWInternalLog").internalLog("send message is not successfully: "+a),c("promiseDone")(d("WALoggerDeferred").logWithTags(j,["Sending message failed:"+JSON.stringify(a)],"ERROR")),c("promiseDone")(C(h)));x.addMarkerPoint(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.SEND_MESSAGE_TO_BACKEND_FAILED,"AppTiming");throw a}});return function(a){return f.apply(this,arguments)}}()),c("emptyFunction"),function(a){x.failTrace(a,!0);throw c("unrecoverableViolation")("Encountered failure during Armadillo Message Send (UI)","messenger_e2ee_web",{error:a})})})})}}g["default"]=a}),98);
__d("MAWMediaManagerUtilsDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";a=c("requireDeferred")("MAWMediaManagerUtils").__setRef("MAWMediaManagerUtilsDeferred");b=a;g["default"]=b}),98);
__d("useMWCurrentVisibleMessage",["I64","Int64Hooks","LSFactory","LSMessagePointQuery","MWMessageElementRefList.bs","MWPVisibleMessageContext.react","ReQL","ReQLSuspense","promiseDone","react","setTimeout","useReStore"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useEffect,j=b.useRef,k=b.useState;function a(a,b){var e=d("MWPVisibleMessageContext.react").useMWPVisibleMessageContext(),g=e.visibleMessage,l=j(d("MWMessageElementRefList.bs").make()),m=a==null?void 0:a.threadKey;e=a==null?void 0:a.threadType;var n=j(),o=c("useReStore")(),p=d("ReQLSuspense").useFirst(function(){if(m==null)return d("ReQL").empty();if(g==null)return d("ReQL").fromTableDescending(o.table("messages_ranges_v2__generated")).getKeyRange(m);var a=g.timestamp;return d("ReQL").fromTableDescending(o.table("messages_ranges_v2__generated")).getKeyRange(m).bounds({lte:{hd:a,tl:0}}).filter(function(b){var c=b.maxTimestampMs;b=b.minTimestampMs;return d("I64").ge(a,b)&&d("I64").le(a,c)})},[m,g,o],f.id+":56"),q=k(function(){return p}),r=q[0],s=q[1];i(function(){n.current=void 0,g==null&&b.current!=null&&b.current.scrollToBottom()},[b,g]);var t=h(function(a){var d=b.current;if(d!=null){c("setTimeout")(function(){return d.scrollElementIntoViewIfNeeded(a)},0);return}},[b]),u=h(function(a){if(a!==n.current)return l.current.get(a,function(b){t(b),n.current=a})},[t]);i(function(){p!=null?s(p):g==null&&s(function(){})},[g,p,s]);i(function(){g!=null&&r!=null&&u(g.messageId)},[o,g,r,u]);d("Int64Hooks").useEffectInt64(function(){if(a!=null&&p==null&&g!=null){var b=g.messageId;c("promiseDone")(o.runInTransaction(function(d){return c("LSMessagePointQuery")(a.threadKey,b,a.threadType,c("LSFactory")(d))},"readwrite"))}},[o,g,p,m,e,a]);return{messageElementRefs:l,messageRange:r,visibleMessage:(q=g)!=null?q:void 0}}g["default"]=a}),98);
__d("MWV2ChatImagePlaceholder.bs",["CometObjectFitContainer.react","MDSGlimmer.react","MWPStableImage.bs","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={glimmer:{display:"x1lliihq",height:"x5yr21d",width:"xh8yej3",$$css:!0}};function a(a){var b=a.height;a=a.width;if(a==null)return null;if(b==null)return null;var e=a/b;return h.jsx(d("MWPStableImage.bs").Container.make,{aspectRatio:e,className:c("stylex")(!1),height:b,maxHeight:200,maxWidth:480,width:a,children:h.jsx(c("CometObjectFitContainer.react"),{contentAspectRatio:e,objectFitMode:"CONTAINER_WIDTH_BASED_ASPECT_RATIO",children:h.jsx(c("MDSGlimmer.react"),{index:1,xstyle:i.glimmer})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSecureAttachment.react",["CometPlaceholder.react","I64","LSIntEnum","MAWAttachmentBlob.react","MAWChatFile.react","MAWGetAttachmentThumbnailBlob","MWAudioPlayer.react","MWPMessageIsReply.bs","MWPMessageListAttachmentContainer.react","MWV2ChatImage.react","MWV2ChatImagePlaceholder.bs","MWV2ChatVideo.bs","MWV2Sticker.react","MWXMAAttachment.react","MessagingAttachmentType","ReQL","ReQLSuspense","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function i(a){var b=a.connectBottom,e=a.connectTop,f=a.dbAttachment,g=a.message;a=a.outgoing;var i=f.attachmentType;switch(!0){case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE)):return h.jsx(c("CometPlaceholder.react"),{fallback:h.jsx(c("MWV2ChatImagePlaceholder.bs"),{height:f.previewHeight!=null?d("I64").to_float(f.previewHeight):f.previewHeightLarge!=null?d("I64").to_float(f.previewHeightLarge):void 0,width:f.previewWidth!=null?d("I64").to_float(f.previewWidth):f.previewWidthLarge!=null?d("I64").to_float(f.previewWidthLarge):void 0}),children:h.jsx(c("MWV2ChatImage.react"),{attachment:f,connectTop:e,getPlayableUrl:d("MAWAttachmentBlob.react").getAttachmentBlob,getPreviewUrl:c("MAWGetAttachmentThumbnailBlob"),message:g,navigateToRouteForMediaViewer:!1,outgoing:a})});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO)):return h.jsx(c("CometPlaceholder.react"),{fallback:h.jsx(c("MWV2ChatImagePlaceholder.bs"),{height:f.previewHeight!=null?d("I64").to_float(f.previewHeight):f.previewHeightLarge!=null?d("I64").to_float(f.previewHeightLarge):void 0,width:f.previewWidth!=null?d("I64").to_float(f.previewWidth):f.previewWidthLarge!=null?d("I64").to_float(f.previewWidthLarge):void 0}),children:h.jsx(c("MWV2ChatVideo.bs"),{attachment:f,connectTop:e,getPreviewUrl:d("MAWAttachmentBlob.react").getAttachmentBlob,message:g,navigateToRouteForMediaViewer:!1,outgoing:a})});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO)):return h.jsx(d("MWAudioPlayer.react").MWAudioPlayer,{attachment:f,getPlayableUrl:d("MAWAttachmentBlob.react").getAttachmentBlob,isReply:c("MWPMessageIsReply.bs")(g),outgoing:a});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)):return h.jsx(c("CometPlaceholder.react"),{fallback:h.jsx(c("MWV2ChatImagePlaceholder.bs"),{height:f.previewHeight!=null?d("I64").to_float(f.previewHeight):f.previewHeightLarge!=null?d("I64").to_float(f.previewHeightLarge):void 0,width:f.previewWidth!=null?d("I64").to_float(f.previewWidth):f.previewWidthLarge!=null?d("I64").to_float(f.previewWidthLarge):void 0}),children:h.jsx(c("MWV2ChatImage.react"),{attachment:f,connectTop:e,getPlayableUrl:d("MAWAttachmentBlob.react").getAttachmentBlob,getPreviewUrl:d("MAWAttachmentBlob.react").getAttachmentBlob,message:g,navigateToRouteForMediaViewer:!1,outgoing:a})});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").STICKER)):return h.jsx(c("MWV2Sticker.react"),{attachment:f,getPreviewUrl:d("MAWAttachmentBlob.react").getAttachmentBlob});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA)):return h.jsx(d("MWXMAAttachment.react").MWXMAAttachment,{attachment:f,connectBottom:b,connectTop:e,getFaviconUrlXMA:function(a,b){return d("MAWAttachmentBlob.react").getInfoUrlXMA(a,"favicon")},getHeaderUrlXMA:function(a){return d("MAWAttachmentBlob.react").getInfoUrlXMA(a,"header")},getPlayableUrl:function(a,b){return d("MAWAttachmentBlob.react").getInfoUrlXMA(a,"preview")},getPreviewUrlXMA:function(a,b){return d("MAWAttachmentBlob.react").getInfoUrlXMA(a,"preview")},outgoing:a});case d("I64").equal(i,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE)):return h.jsx(c("MAWChatFile.react"),{file:f});default:return"Unsupported attachment type"}}i.displayName=i.name+" [from "+f.id+"]";function a(a){var b=a.connectBottom,e=a.connectTop,g=a.message;a=a.outgoing;var j=c("useReStore")(),k=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(j.table("attachments")).getKeyRange(g.threadKey,g.messageId)},[j,g.messageId,g.threadKey],f.id+":222");return k==null?null:h.jsx(c("MWPMessageListAttachmentContainer.react"),{connectTop:e,message:g,paint:d("I64").equal(k.attachmentType,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO))?!1:void 0,children:h.jsx(i,{connectBottom:b,connectTop:e,dbAttachment:k,message:g,outgoing:a})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWEncryptionPlaceholder.react",["fbt","MWV2TombstonedMessage.bs","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(){return i.jsx(c("MWV2TombstonedMessage.bs"),{children:h._("__JHASH__C8O2a78lb6C__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWFutureproofPlaceholder.react",["fbt","MWV2TombstonedMessage.bs","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(){return i.jsx(c("MWV2TombstonedMessage.bs"),{children:h._("__JHASH__rJAaVw-bGTJ__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWUnavailablePlaceholder.react",["fbt","MWV2TombstonedMessage.bs","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(){return i.jsx(c("MWV2TombstonedMessage.bs"),{children:h._("__JHASH__M9fzIhDqITQ__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWUnavailableStoryPlaceholder.react",["fbt","MWV2TombstonedMessage.bs","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(){return i.jsx(c("MWV2TombstonedMessage.bs"),{children:h._("__JHASH__XFKsw63gVvs__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSecurePlaceholder.react",["CometPlaceholder.react","I64","LSIntEnum","MAWEncryptionPlaceholder.react","MAWFutureproofPlaceholder.react","MAWUnavailablePlaceholder.react","MAWUnavailableStoryPlaceholder.react","MWPMessageListColumn.react","ReQL","ReQLSuspense","react","recoverableViolation","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function i(a){var b=c("useReStore")();return d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(b.table("attachments")).getKeyRange(a.threadKey,a.messageId)},[b,a.threadKey,a.messageId],f.id+":32")}function j(a){a=a.message;a=i(a);if(a==null)return null;a=a.defaultCtaType;if(a==="xma_montage_share")return h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("MAWUnavailableStoryPlaceholder.react"),{})});c("recoverableViolation")("Unexpected case where message is tombstone type but the attachment is not xma montage share","messenger_e2ee_web");return h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("MAWUnavailablePlaceholder.react"),{})})}j.displayName=j.name+" [from "+f.id+"]";function a(a){a=a.message;var b=a.displayedContentTypes,e=null;d("I64").equal(b,d("LSIntEnum").ofNumber(65536))?e=h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("MAWEncryptionPlaceholder.react"),{})}):d("I64").equal(b,d("LSIntEnum").ofNumber(131072))?e=h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("MAWFutureproofPlaceholder.react"),{})}):d("I64").equal(b,d("LSIntEnum").ofNumber(262144))?e=h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("MAWUnavailablePlaceholder.react"),{})}):d("I64").equal(b,d("LSIntEnum").ofNumber(256))&&(e=h.jsx(j,{message:a}));return h.jsx(d("MWPMessageListColumn.react").MWPMessageListColumnShrinkwrap,{children:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSecureAttachmentRenderer.react",["CometPlaceholder.react","MAWMsg","MAWSecureAttachment.react","MAWSecurePlaceholder.react","MWPMessageParsingUtils.bs","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a,b,e,f){b=d("MWPMessageParsingUtils.bs").MessageWithAttachments.shouldConnectTop(a,b,"below");e=d("MWPMessageParsingUtils.bs").MessageWithAttachments.shouldConnectBottom(a,e,"below");return h.jsx(c("CometPlaceholder.react"),{fallback:null,children:d("MAWMsg").isMediaMsg(a)||d("MAWMsg").isXMAMsg(a)?h.jsx(c("MAWSecureAttachment.react"),{connectBottom:e,connectTop:b,message:a,outgoing:f}):h.jsx(c("MAWSecurePlaceholder.react"),{message:a})})}a.displayName=a.name+" [from "+f.id+"]";g.render=a}),98);
__d("MAWMessageRetryButton.react",["fbt","MAWBridgeFireAndForget","MAWDbMsg","MWXButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){a=a.message;var b=d("MAWDbMsg").toMsgId(a.messageId);return b!=null&&i.jsx(c("MWXButton.react"),{label:h._("__JHASH__0lUI7bmWtlT__JHASH__"),onPress:function(){return d("MAWBridgeFireAndForget").fireAndForget("backend","retryUploadMedia",{msgId:b})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWAdminViewLogins.react",["fbt","CometPressable.react","JSResourceForInteraction","MWPBumpEntityKey","react","useCometLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j={content:{color:"xz94kzr",cursor:"x1ypdohk",display:"x1rg5ohu",fontWeight:"xo1l8bm",marginStart:"xsgj6o6",$$css:!0}};function a(){var a=c("useCometLazyDialog")(c("JSResourceForInteraction")("MAWTrustedLoginsDialog.react").__setRef("MAWAdminViewLogins.react")),b=a[0];return i.jsx(c("CometPressable.react"),{onPress:function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","trusted_logins");return b({},function(){})},xstyle:j.content,children:h._("__JHASH__tDIDH9AMj9C__JHASH__").toString()})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWFetchMoreMessages",["I64","LSFactory","LSIssueMessagesRangeQuery","MAWBridgeSendAndReceive","MAWDbMsg","MAWInternalLog","MAWMiActOnActThreadReady","Promise","ReQL","ReQLSuspense","gkx","promiseDone","react","useMWEncryptedBackupsIssueRangeQueryDeferred","useReStore"],(function(a,b,c,d,e,f,g){"use strict";a=d("react");var h=a.useCallback,i=a.useMemo;e={useFetchCutoverMessages:function(a,e){var g=c("useReStore")(),i=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(g.table("messages_ranges_v2__generated")).getKeyRange(a)},[g,a],f.id+":39"),j=d("ReQLSuspense").useFirst(function(){return e!=null?d("ReQL").fromTableAscending(g.table("messages_ranges_v2__generated")).getKeyRange(e):d("ReQL").empty()},[g,e],f.id+":46"),k=h(function(a){c("promiseDone")(g.runInTransaction(function(d){if(e!=null&&j!=null)return c("LSIssueMessagesRangeQuery")(e,j.minTimestampMs,a,c("LSFactory")(d));else return b("Promise").resolve()},"readwrite"))},[g,j,e]),l=c("useMWEncryptedBackupsIssueRangeQueryDeferred")();return h(function(b){if(i==null)return;var e=i.hasMoreBefore,f=d("MAWDbMsg").toMsgId(i.minMessageId);c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(g,a,"MAWFetchMoreMessages",function(a,c,g){d("MAWInternalLog").internalLog("useFetchCutoverMessages: start loadMoreMsgs");return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMsgs",{direction:"before",numMsgs:10,offsetMsgId:f,threadId:c}).then(function(a){d("MAWInternalLog").internalLog("useFetchCutoverMessages: response is "+a.hasMoreBefore.toString());if(a.hasMoreBefore)return;return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMaybeNextNonAdminMsgSortOrderMs",{mayBeAdminMsgId:f,threadId:c}).then(function(a){l(c,d("I64").of_float(a.minMsgTimestampMs),d("I64").of_string("10"),d("I64").zero);if(!e)return k(b)})})}))},[i,g,a,l,k])},useFetchSecureMessages:function(){var a=c("useReStore")(),e=c("useMWEncryptedBackupsIssueRangeQueryDeferred")();return i(function(){return function(f,g,h){d("MAWInternalLog").internalLog("useFetchSecureMessages: started to get message range");return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("messages_ranges_v2__generated")).getKeyRange(g)).then(function(i){if(i!=null&&!i.isLoadingBefore&&h==="before")return d("MAWMiActOnActThreadReady").onActThreadReady(a,g,"MAWFetchMoreMessages",function(a,b,g){d("MAWInternalLog").internalLog("useFetchSecureMessages: put message range");return f.table("messages_ranges_v2__generated").put({hasMoreAfter:i.hasMoreAfter,hasMoreBefore:i.hasMoreBefore,isLoadingAfter:i.isLoadingAfter,isLoadingBefore:!0,maxMessageId:i.maxMessageId,maxTimestampMs:i.maxTimestampMs,minMessageId:i.minMessageId,minTimestampMs:i.minTimestampMs,threadKey:i.threadKey}).then(function(){d("MAWInternalLog").internalLog("useFetchSecureMessages: loadMoreMsgs started"),c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMsgs",{direction:h,numMsgs:10,offsetMsgId:d("MAWDbMsg").toMsgId(i.minMessageId),threadId:b}).then(function(a){d("MAWInternalLog").internalLog("useFetchSecureMessages: response is "+a.hasMoreBefore.toString());if(a.hasMoreBefore)return;return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMaybeNextNonAdminMsgSortOrderMs",{mayBeAdminMsgId:d("MAWDbMsg").toMsgId(i.minMessageId),threadId:b}).then(function(a){d("MAWInternalLog").internalLog("useFetchSecureMessages: minMsgSortOrderTsResponse "+a.minMsgTimestampMs);return e(b,d("I64").of_float(a.minMsgTimestampMs),d("I64").of_string("10"),d("I64").zero)})}))})});return c("gkx")("8830")&&i!=null&&!i.isLoadingAfter&&h==="after"?d("MAWMiActOnActThreadReady").onActThreadReady(a,g,"MAWFetchMoreMessages",function(a,b,e){d("MAWInternalLog").internalLog("useFetchSecureMessages: put message range");return f.table("messages_ranges_v2__generated").put({hasMoreAfter:i.hasMoreAfter,hasMoreBefore:i.hasMoreBefore,isLoadingAfter:!0,isLoadingBefore:i.isLoadingBefore,maxMessageId:i.maxMessageId,maxTimestampMs:i.maxTimestampMs,minMessageId:i.minMessageId,minTimestampMs:i.minTimestampMs,threadKey:i.threadKey}).then(function(){d("MAWInternalLog").internalLog("useFetchSecureMessages: loadMoreMsgs started"),c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMsgs",{direction:"after",numMsgs:10,offsetMsgId:d("MAWDbMsg").toMsgId(i.maxMessageId),threadId:b}).then(function(a){d("MAWInternalLog").internalLog("useFetchSecureMessages: response is "+a.hasMoreAfter.toString())}))})}):b("Promise").resolve()})}},[a,e])}};a=e;g["default"]=a}),98);
__d("MAWHotLike.react",["MWPColorUtils","MWPThreadTheme.bs","MessengerHotLikeSVGReact.bs","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={likePreview:{display:"x78zum5","float":"x1guec7k",height:"x1dnml7z",width:"x7tvc40",$$css:!0},noCustomLikePreview:{display:"x78zum5",justifyContent:"xl56j7k",$$css:!0}};function a(a){a=a.xstyle;var b=d("MWPThreadTheme.bs").useHook();b=d("MWPColorUtils").int64ToHex(b.threadTheme.fallbackColor);return h.jsx("div",{className:c("stylex")(i.likePreview,i.noCustomLikePreview,a),children:h.jsx(d("MessengerHotLikeSVGReact.bs").make,{color:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWMessageListRow.react",["I64","Int64Hooks","LSMessagingThreadTypeUtil","MWMessageRow.react","MWPVisibleMessageContext.react","MWV2MessageActionsVisibility.bs","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.domElementRef,c=a.modal,e=a.renderAttachment,f=a.row,g=a.thread;a=d("MWV2MessageActionsVisibility.bs").useStopHoveringRef();var i=d("LSMessagingThreadTypeUtil").isSecure(g.threadType),j=d("MWPVisibleMessageContext.react").useMWPVisibleMessageContext();j=j.visibleMessage;var k=f.message;i=i?d("I64").equal(g.threadKey,k.threadKey):!1;var l=!1;if(j!=null){var m=j.messageId;switch(j.source){case"Reply":case"Pinned":l=m===k.messageId;break;default:l=!1}}j={domElementRef:b,hasMessageEmphasisRing:l,isModal:c===k.messageId,isSecureMessage:i,message:k,nextMessage:f.nextMessage,prevMessage:f.prevMessage,renderAttachment:e,stopHoveringRef:a,threadType:d("Int64Hooks").useMemoInt64(function(){return g.threadType},[g.threadType])};return h.jsx(d("MWMessageRow.react").MWMessageRow,babelHelpers["extends"]({},j))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWPOneToOneThreadBlockedContext.bs",["I64","Int64Hooks","LSContactBlockedByViewerStatus","LSIntEnum","MWV2OneToOneThreadBlockedContext.bs","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.children,e=a.participants,f=a.thread;a=d("Int64Hooks").useMemoInt64(function(){if(!(d("I64").equal(f.threadType,d("LSIntEnum").ofNumber(1))||d("I64").equal(f.threadType,d("LSIntEnum").ofNumber(15))))return!1;var a={contents:!1};e.forEach(function(b,e,f){if(!d("I64").equal(b[1].blockedByViewerStatus,d("LSIntEnum").ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED))){a.contents=!0;return}});return a.contents},[f.threadType,e]);return h.jsx(d("MWV2OneToOneThreadBlockedContext.bs").make,{blocked:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2SeenHead.bs",["GenderConst","I64","LSIntEnum","LSMediaUrl.bs","MWMessageDeliveryStatus"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b,e=a[1];a=a[0];return{gender:c("GenderConst").NOT_A_PERSON,id:d("I64").to_string(e.id),imageSrc:d("LSMediaUrl.bs").Contact.profilePictureUrl(e),name:(b=a.nickname)!=null?b:e.name,timestamp:d("I64").to_float(a.readActionTimestampMs)}}function a(a,b){var c={contents:d("I64").zero};a.forEach(function(a,e,f){e=a[0];if(!d("I64").equal(e.contactId,b)&&d("I64").gt(e.deliveredWatermarkTimestampMs,c.contents)){c.contents=e.deliveredWatermarkTimestampMs;return}});return c.contents}function b(a){return new Set([d("I64").to_string(a)])}function e(a,b,c,e,f,g){var i=[];b.forEach(function(b,e,f){if(c.has(e)||a.isAdminMessage)return;if(!d("I64").equal(a.sendStatusV2,d("LSIntEnum").ofNumber(2)))return;f=b[0];var j=d("I64").equal(a.senderId,f.contactId);f=d("I64").le(a.timestampMs,f.readWatermarkTimestampMs);if(j||f){i.push(h(b));if(!g){c.add(e);return}else return}});var j=i.length===0&&c.size===1;if(i.length<=0)if(d("I64").equal(a.senderId,f))return d("MWMessageDeliveryStatus").getDeliveryStatusForMessageSentByYou(a,e,j);else return{type:"NoneStatus"};if(!g)if(i.length>1)return{heads:i,type:"MultipleSeenHeads"};else return{head:i[0],type:"SingleSeenHead"};f=i.length===(b.size-1|0);return{delivered:f,heads:i,type:"DeliveredAndRead"}}g.calculateMaxDeliveredTimestamp=a;g.makeExistingSeenHeads=b;g.deliveryStatusForMessage=e}),98);
__d("MWPBaseMessageList_DEPRECATED.bs",["BaseHeadingContextWrapper.react","LSMessagingThreadTypeUtil","MWPActor.react","MWPMessageAuthor.react","MWPOneToOneThreadBlockedContext.bs","MWV2SeenHead.bs","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.children,e=a.messages,f=a.participants,g=a.renderRow;a=a.thread;var i=d("MWPActor.react").useActor(),j=d("MWV2SeenHead.bs").calculateMaxDeliveredTimestamp(f,i),k=d("MWV2SeenHead.bs").makeExistingSeenHeads(i),l=d("LSMessagingThreadTypeUtil").isGroup(a.threadType)&&d("LSMessagingThreadTypeUtil").isSecure(a.threadType),m=[];for(var n=e.length-1|0;n>=0;--n){var o=n===0?void 0:e[n-1|0],p=n>=(e.length-1|0)?void 0:e[n+1|0],q=e[n],r=d("MWV2SeenHead.bs").deliveryStatusForMessage(q,f,k,j,i,l);m.push(h.jsx(d("MWPMessageAuthor.react").MWPMessageAuthor,{contactId:q.senderId,threadKey:q.threadKey,children:g({message:q,nextMessage:p,prevMessage:o,status:r})},q.messageId))}if(m.length===0)return null;else return h.jsx(c("BaseHeadingContextWrapper.react"),{children:h.jsx("div",{className:"x1ja2u2z",children:h.jsx(c("MWPOneToOneThreadBlockedContext.bs"),{participants:f,thread:a,children:b(m.reverse())})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWMessageList_DEPRECATED.react",["BaseTheme.react","CometPagelet.react","CometScreenReaderText.react","I64","Int64Hooks","MAWLoadingStateOutstandingOfflineQueueSelector","MAWMessageListRow.react","MAWStateContext.react","MWBaseTheme","MWMessageRow.react","MWPBaseMessageList_DEPRECATED.bs","MWPMessageListColumn.react","MWPMessageListFocusTable.react","MWPThreadCapabilitiesContext","MWPTypingIndicators.react","MWV2MessageRowSimple.react","ReQL","ReQL.bs","ReQLSuspense","cr:4242","cr:6046","react","useCometUniqueID","useMWPAriaLabelForMessageListGrid","useReStore","withCometPlaceholder"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react"),j=i.useEffect,k=i.useState,l={messageBubble:{backgroundColor:"x1vtvx1t",$$css:!0}};function m(a,b){return new Map(d("ReQLSuspense").useArray(function(){return d("ReQL.bs").map(d("ReQL.bs").mergeJoin(d("ReQL").fromTableAscending(b.table("participants")).getKeyRange(a.threadKey),d("ReQL").fromTableAscending(b.table("contacts"))),function(a){var b=a[0];a=a[1];return[d("I64").to_string(a.id),[b,a]]})},[b,a.threadKey],f.id+":93"))}function n(a,b){j(function(){var c;if((a==null?void 0:(c=a.scrollPositionRef.current)==null?void 0:c.TAG)===0&&b.length>0){c=a.scrollerRef.current;c==null?void 0:c.scrollToBottom()}},[b,a])}function a(a){var b=a.scrollerRefs,e=a.theme;e=e===void 0?d("MWBaseTheme").empty:e;var f=a.threadKey;a=a.threadType;var g=d("MWPTypingIndicators.react").useTypingParticipants(f),i=d("MWPTypingIndicators.react").useAccessibilityText(g);n(b,g);if(g.length>0)return h.jsx(c("BaseTheme.react"),{config:e,children:h.jsx(c("MWV2MessageRowSimple.react"),{children:h.jsxs(d("MWPMessageListColumn.react").MWPMessageListColumnGrow,{children:[h.jsx("div",{"aria-live":"polite",children:h.jsx(c("CometScreenReaderText.react"),{text:i})}),h.jsx(d("MWPTypingIndicators.react").MWPTypingIndicators,{messageBubbleStyle:l.messageBubble,threadKey:f,threadType:a})]})})});else return null}var o=d("withCometPlaceholder").withCometPlaceholder(a);function e(a){var e=a.messageElementRefs,f=a.messages,g=a.renderAttachment,i=a.scrollerRefs,j=a.thread;a=c("useReStore")();a=m(j,a);var l=c("useMWPAriaLabelForMessageListGrid")(j),n=d("MWMessageRow.react").useTheme(),p=k(""),q=p[0],r=p[1],s=c("useCometUniqueID")(),t=d("Int64Hooks").useMemoInt64(function(){return j.threadType},[j.threadType]);p=f.length>1?d("I64").to_float(f[f.length-1].timestampMs)<d("I64").to_float(j.lastActivityTimestampMs):!0;var u=d("MAWStateContext.react").useMAWSelector(d("MAWLoadingStateOutstandingOfflineQueueSelector").outstandingOfflineQueueSelector);u=!u&&p;return h.jsxs(h.Fragment,{children:[h.jsx(c("MWPBaseMessageList_DEPRECATED.bs"),{messages:f,participants:a,renderRow:function(a){var b=a.message,d=a.nextMessage;a=a.prevMessage;return h.jsx(c("MAWMessageListRow.react"),{domElementRef:e.set(b.messageId),modal:q,renderAttachment:g,row:{message:b,nextMessage:d,prevMessage:a},thread:j})},thread:j,children:function(a){a=h.jsxs(h.Fragment,{children:[a,h.jsx(o,{scrollerRefs:i,theme:n,threadKey:j.threadKey,threadType:t})]});return h.jsx("div",{"data-testid":void 0,id:s,children:h.jsx(d("CometPagelet.react").Placeholder,{fallback:null,name:"MWV2MessageList",children:h.jsx(d("MWPThreadCapabilitiesContext").Provider,{thread:j,children:h.jsx(c("MWPMessageListFocusTable.react"),{ariaLabel:l,modal:q,setModal:r,children:b("cr:4242")==null?a:h.jsx(b("cr:4242"),{id:s,children:a})})})})})}}),u&&b("cr:6046")?h.jsx(b("cr:6046"),{}):null]})}e.displayName=e.name+" [from "+f.id+"]";g["default"]=e}),98);
__d("useSecureThreadDetailGetDevices",["I64","MAWJids","MAWJobDefinitions","MAWTimedJob","ReQL","ReQLSuspense","WAJobOrchestratorTypes","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useEffect,i=b.useRef;function a(a,b){var e=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(b.table("participants")).getKeyRange(a.threadKey).filter(function(b){return!d("I64").equal(b.contactId,a.threadKey)}).map(function(a){return d("MAWJids").toUserJid(d("I64").to_string(a.contactId))})},[b,a.threadKey],f.id+":30"),g=i(new Set());h(function(){var a=g.current.size!==e.length||!e.every(function(a){return g.current.has(a)});if(!a&&e.length>2)return;a=new Set(e);g.current=a;c("promiseDone")(d("MAWTimedJob").TimedUIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("getDevices",{ignoreDhash:!1,reason:"details-participants-changed",scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW},users:a})))},[e])}g["default"]=a}),98);
__d("MAWSecureThreadDetail_DEPRECATED.bs",["CometHeroHoldTrigger.react","CometPagelet.react","CometPlaceholder.react","ComponentMountUnmountSubspanLogger.react","I64","Int64Hooks","LSAuthorityLevel","LSIntEnum","LSMailboxMessagesRangeQueryDirection","LSMessagingThreadTypeUtil","MAWArmadilloLinkContext.react","MAWFetchMoreMessages","MAWMessageList_DEPRECATED.react","MAWSecureAttachmentRenderer.react","MWChatLoadMoreItemsIncrementally.bs","MWInboxThreadMessagesSpinner.react","MWPMessageListColumn.react","MWV2ContextBanner.react","MWV2MessageScroller.bs","ReQL","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","SortedAsyncIterable.bs","cr:2522","gkx","logMessengerWebFalcoEvent","promiseDone","react","useMAWMarkThreadAsRead","useMWCurrentVisibleMessage","useMWV2ConversationScrollerRefs","useReStore","useSecureThreadDetailGetDevices"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useCallback,j=e.useMemo,k=e.useState,l=3;function m(a,b){var c=d("I64").compare(a.primarySortKey,b.primarySortKey);if(c!==0)return c;c=d("I64").compare(a.secondarySortKey||d("I64").of_int32(0),b.secondarySortKey||d("I64").of_int32(0));return c!==0?c:d("I64").compare(a.timestampMs,b.timestampMs)}function n(a,b){var e=c("useReStore")();return d("ReQLSuspense").useArray(function(){var f=d("ReQL.bs").fromIndexAscending(e.table("messages").index("messageDisplayOrder")).getKeyRange(b.threadKey);if(a!=null)return f.bounds({gte:d("ReQL").key(a.minTimestampMs),lte:d("ReQL").key(a.maxTimestampMs)});else if(d("I64").lt(b.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))||d("LSMessagingThreadTypeUtil").isSecure(b.threadType))return f;else return d("SortedAsyncIterable.bs").empty()},[e,a,b.authorityLevel,b.threadKey,b.threadType],f.id+":98")}function o(a,b){var e=c("useReStore")();return d("ReQLSubscription.bs").useArray(d("Int64Hooks").useMemoInt64(function(){if(b==null)return d("SortedAsyncIterable.bs").empty();var f=d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("messages")),{hd:b.threadKey,tl:0});if(a!=null)return d("ReQL.bs").bounds(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("messages")),{hd:b.threadKey,tl:0}),{NAME:"range",VAL:[{NAME:"greaterThanOrEqual",VAL:{hd:a.minTimestampMs,tl:0}},{NAME:"lessThanOrEqual",VAL:{hd:a.maxTimestampMs,tl:0}}]});else if(d("I64").lt(b.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))||d("LSMessagingThreadTypeUtil").isSecure(b.threadType))return f;else return d("SortedAsyncIterable.bs").empty()},[e,b,a]),"g1rvq8q6",f.id+":133")}function p(a,b){var c=d("I64").compare(a.primarySortKey,b.primarySortKey);if(c!==0)return c;c=a.secondarySortKey;var e=b.secondarySortKey;if(c==null)if(e!=null)return-1;else return d("I64").compare(a.timestampMs,b.timestampMs);if(e==null)return 1;c=d("I64").compare(c,e);if(c!==0)return c;else return d("I64").compare(a.timestampMs,b.timestampMs)}function q(a,b,e,f,g){var h=n(a,e),i=o(b,f);d("Int64Hooks").useEffectInt64(function(){if(f!=null&&i.length===0){var a=f.threadKey,b=f.threadType;c("logMessengerWebFalcoEvent")({threadKey:a,threadType:b},"no_open_messages_in_cutover_thread",g,{cutoverThreadKey:d("I64").to_string(e.threadKey),reason:"no_messages_fetched_for_open"})}},[g,i.length,f,e.threadKey]);return j(function(){if(a!=null&&!a.hasMoreBefore)return i.sort(p).concat(h.sort(m));else return h.sort(m)},[a,h,i])}var r=c("gkx")("4710")?c("MAWFetchMoreMessages").useFetchCutoverMessages:function(a,b){var e=c("useReStore")(),f=c("MAWFetchMoreMessages").useFetchSecureMessages();return d("Int64Hooks").useCallbackInt64(function(b){var g=d("I64").equal(b,d("LSIntEnum").ofNumber(c("LSMailboxMessagesRangeQueryDirection").AFTER))?"after":"before";c("promiseDone")(e.runInTransaction(function(b){return f(b,a,g).then(function(){})},"readwrite"))},[e,f,a])};function a(a){var e,f=a.cutoverOpenThread,g=a.entryPoint;a=a.thread;var j=c("useMWV2ConversationScrollerRefs")(),m=c("useReStore")(),n=i(function(){var a;return((a=j.scrollPositionRef.current)==null?void 0:a._0)===void 0&&((a=j.scrollPositionRef.current)==null?void 0:a.TAG)===0},[j]),o=r(a.threadKey,f==null?void 0:f.threadKey),p=c("useMWCurrentVisibleMessage")(a,j.scrollerRef),s=p.messageRange,t=c("useMWCurrentVisibleMessage")(f,j.scrollerRef);t=t.messageRange;e=(e=s==null?void 0:s.hasMoreAfter)!=null?e:!1;var u=k(!1),v=u[0],w=u[1];o=d("MWChatLoadMoreItemsIncrementally.bs").useLoadMore(e,void 0,void 0,q(s,t,a,f,g),o,(u=s==null?void 0:s.hasMoreBefore)!=null?u:!1);u=o[0];var x=o[1];o=o[2];c("useSecureThreadDetailGetDevices")(a,m);m=s==null||s.isLoadingBefore;s=f!=null&&(t==null||t.isLoadingBefore);t=u.length>=l;return h.jsxs(h.Fragment,{children:[h.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MAWCutoverEncryptedBackupsBanner",children:b("cr:2522")!=null&&f&&h.jsxs(h.Fragment,{children:[h.jsx(b("cr:2522"),{isShown:v,thread:a}),h.jsx(c("CometHeroHoldTrigger.react"),{description:"MAWCutoverLoadingMessages",hold:s&&!t})]})}),h.jsxs(d("MAWArmadilloLinkContext.react").MAWArmadilloLinkProvider,{children:[h.jsx(c("ComponentMountUnmountSubspanLogger.react"),{description:"MAWSecureThreadDetail"}),h.jsxs(c("MWV2MessageScroller.bs"),{fetchMore:x,hasMoreAfter:e,hasMoreBefore:o,lastMessageToCalculateIfThreadIsRead:u.length!==0?u[u.length-1]:void 0,markThreadAsRead:c("useMAWMarkThreadAsRead")(a,g),onScroll:function(){w(!n())},scrollerRefs:j,thread:a,children:[h.jsxs(d("MWPMessageListColumn.react").MWPMessageListColumnShrinkwrap,{children:[h.jsx(d("MWPMessageListColumn.react").MWPMessageListColumnVerticalRhythm,{height:20}),h.jsx(c("CometHeroHoldTrigger.react"),{description:"MAWLoadingMessages",hold:m&&!t}),o?h.jsx(c("MWInboxThreadMessagesSpinner.react"),{}):h.jsx(c("MWV2ContextBanner.react"),{thread:a}),h.jsx(d("MWPMessageListColumn.react").MWPMessageListColumnVerticalRhythm,{height:10})]}),h.jsx(d("MWPMessageListColumn.react").MWPMessageListColumnGrow,{children:null}),h.jsx(d("CometPagelet.react").Placeholder,{fallback:null,name:"MAWMessageList",children:h.jsx(c("MAWMessageList_DEPRECATED.react"),{messageElementRefs:p.messageElementRefs.current,messages:u,renderAttachment:d("MAWSecureAttachmentRenderer.react").render,scrollerRefs:j,thread:a})}),e?h.jsx(c("MWInboxThreadMessagesSpinner.react"),{}):null]})]})]})}a.displayName=a.name+" [from "+f.id+"]";g.messageSortOrder=m;g.useMessagesUnsorted=n;g.useMessagesWithMaybeCutover=q;g.MAWSecureThreadDetail_DEPRECATED=a}),98);
__d("MAWSecureThreadDetailWrapper.bs",["CometErrorBoundary.react","CometHeroHoldTrigger.react","FBLogger","I64","Int64Hooks","LSAuthorityLevel","LSFactory","LSInitiateThreadMigration","LSIntEnum","MAWMiActLoadExistingThread","MAWMiActOnActThreadReady","MAWSecureThreadDetail_DEPRECATED.bs","MAWThreadCutover.bs","MWFailChatTabOpenQPLEvent","QPLUserFlow","WAHex","cr:1271","cr:1746","cr:1957","cr:1999","cr:4646","emptyFunction","gkx","logMessengerWebFalcoEvent","qpl","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useCallback,j=e.useRef,k=e.useState,l=b("cr:1999")==null?void 0:b("cr:1999").make;e=(e=b("cr:1271"))!=null?e:{};var m=e.sendAndReceive,n=(e=b("cr:4646"))!=null?e:c("emptyFunction");function a(a){var e=a.entryPoint,f=a.messageListRef,g=a.thread,p=d("I64").to_int32(g.threadKey);d("Int64Hooks").useEffectInt64(function(){c("QPLUserFlow").start(c("qpl")._(25306607,"1883"),{annotations:{string:{entryPoint:e,thread_id:d("I64").to_string(g.threadKey)}},instanceKey:p})},[e,p,g.threadKey]);var q=i(function(a){c("QPLUserFlow").addPoint(c("qpl")._(25306607,"1883"),a,{instanceKey:p})},[p]),r=c("useReStore")(),s=i(function(a,b){return r.runInTransaction(function(e){return c("LSInitiateThreadMigration")(a,b,!1,d("WAHex").randomHex(8),c("LSFactory")(e))},"readwrite")},[r]),t=d("MAWThreadCutover.bs").useGetCutoverMapping(g.threadKey);a=d("MAWThreadCutover.bs").useCutoverOpenThread(g.threadKey);n({thread:g});var u=j(""),v=k("loading"),w=v[0],x=v[1];v=k(0);var y=v[0],z=v[1];d("Int64Hooks").useEffectInt64(function(){if(w==="show"||w==="hide")return;if(t==null){x("not_cutover_thread");c("QPLUserFlow").endSuccess(c("qpl")._(25306607,"1883"),{annotations:{string:{isCutover:"false"}},instanceKey:p});return}if(m==null){u.current="sendAndReceive_is_null";x("error");return}q("act_thread_loading");void d("MAWMiActOnActThreadReady").onActThreadReady(r,g.threadKey,"MAWSecureThreadDetailWrapper.bs",function(a,b,e){return m("backend","checkIfShowOpenMessageHistory",{chatId:b,timestampMs:d("I64").to_float(t.timestampMs)}).then(function(a){q("act_thread_loaded");var b=a?"show":"hide";x(b);c("QPLUserFlow").addAnnotations(c("qpl")._(25306607,"1883"),{string:{showOpenHistory:b}},{instanceKey:p});return a}).then(function(a){if(a){q("thread_migration_initiating");return s(t==null?void 0:t.openThreadId,t==null?void 0:t.armadilloThreadId).then(function(){q("thread_migration_completed"),c("QPLUserFlow").endSuccess(c("qpl")._(25306607,"1883"),{annotations:{string:{isCutover:"true"}},instanceKey:p})})}else c("QPLUserFlow").endSuccess(c("qpl")._(25306607,"1883"),{annotations:{string:{isCutover:"true"}},instanceKey:p})})["catch"](function(a){u.current="fail_to_init_thread_migration",x("error"),c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("fail_to_init_thread_migration"),c("QPLUserFlow").endFailure(c("qpl")._(25306607,"1883"),a.toString(),{annotations:{string:{isCutover:"true"}},instanceKey:p})})},function(){y<3?(void c("MAWMiActLoadExistingThread")(r,g.threadKey),z(function(a){return a+1})):(u.current="chatid_is_null",x("error"))})},[q,t,r,z,s,p,w,g.threadKey,y]);var A=a!=null;d("Int64Hooks").useEffectInt64(function(){if(u.current==="")return;if(w!=="hide"){var a;c("logMessengerWebFalcoEvent")({threadKey:g.threadKey,threadType:g.threadType},"no_open_messages_in_cutover_thread",e,{cutoverThreadKey:d("I64").to_string((a=t==null?void 0:t.openThreadId)!=null?a:d("I64").neg_one),hasCutoverOpenThread:A.toString(),reason:u.current,showOpenMsgHistoryState:w})}switch(w){case"loading":break;case"not_cutover_thread":case"hide":case"show":c("QPLUserFlow").endSuccess(c("qpl")._(25306607,"1883"),{annotations:{string:{isCutover:"true"}},instanceKey:p});case"error":c("QPLUserFlow").endFailure(c("qpl")._(25306607,"1883"),u.current,{annotations:{string:{isCutover:"true"}},instanceKey:p});break;default:w;throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("[MiActMapping] Unreachable showOpenMsgHistoryState: %s",w)}},[t,e,w,A,g.threadKey,g.threadType,p]);if(!c("gkx")("4710")&&l!=null&&a!=null&&t!=null&&w==="show"&&d("I64").equal(a.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))){u.current="";return h.jsx(o,{message:"Error while loading cutover thread messages",threadKey:g.threadKey,children:b("cr:1746")!=null?h.jsx(b("cr:1746"),{cutoverOpenThread:a,entryPoint:e,messageListRef:f,thread:g}):h.jsx(l,{cutoverOpenThread:a,entryPoint:e,thread:g})})}v=w==="show"&&(a==null||!d("I64").equal(a.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)));return h.jsx(o,{message:"Error while loading secure thread messages",threadKey:g.threadKey,children:h.jsxs(h.Fragment,{children:[h.jsx(c("CometHeroHoldTrigger.react"),{description:"MAWCutoverShowHistoryDetermination",hold:w==="loading"||v}),b("cr:1957")!=null?h.jsx(b("cr:1957"),{cutoverOpenThread:c("gkx")("4710")&&w==="show"?a:void 0,entryPoint:e,messageListRef:f,thread:g}):h.jsx(d("MAWSecureThreadDetail_DEPRECATED.bs").MAWSecureThreadDetail_DEPRECATED,{cutoverOpenThread:c("gkx")("4710")&&w==="show"?a:void 0,entryPoint:e,thread:g})]})})}a.displayName=a.name+" [from "+f.id+"]";function o(a){var b=a.children,d=a.message,e=a.threadKey;return h.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},onError:function(a){c("MWFailChatTabOpenQPLEvent")(e,a.toString()),c("FBLogger")("messenger_web_product").catching(a).mustfix(d+": %s",a.toString())},children:b})}o.displayName=o.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWEphemeralAdminMsgCta.react",["CometLazyDialogTrigger.react","CometPressable.react","CometTextWithEntities.react","JSResourceForInteraction","react","useThreadJid"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.threadKey,d=a.title;a=c("useThreadJid")(b);return h.jsx(c("CometLazyDialogTrigger.react"),{dialogProps:{getThreadJid:a,threadKey:b},dialogResource:c("JSResourceForInteraction")("MAWEphemeralSettingsDialog.react").__setRef("MAWEphemeralAdminMsgCta.react"),children:function(a){return h.jsx(c("CometPressable.react"),{onPress:function(){return a()},children:h.jsx(c("CometTextWithEntities.react"),{text:d})})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWFetchAudioWaveformDataForAttachment",["CometRelay","FBLogger","asyncToGeneratorRuntime","react","useMWFetchAudioWaveformDataForAttachmentQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react").useCallback,j='<mock-value-for-field-"waveform_data">';function a(a){var e=a.attachmentFbid,f=d("CometRelay").useRelayEnvironment();return i(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("CometRelay").fetchQuery(f,h!==void 0?h:h=b("useMWFetchAudioWaveformDataForAttachmentQuery.graphql"),{attachmentFbid:e}).toPromise());a=a==null?void 0:(a=a.node)==null?void 0:a.waveform_data;return a===j?Float32Array.of():Float32Array.from((a=a)!=null?a:[])}catch(a){c("FBLogger")("messenger_web_product","audio_waveform_error").catching(a).mustfix("Error fetching waveform data for attachment FBID: %s",e);return Float32Array.of()}}),[e,f])}g["default"]=a}),98);
__d("MAWUnsendContentInSecureThread",["fbt","MWPMessageAuthor.react"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){a=d("MWPMessageAuthor.react").useAuthorName();a=a[0];return a!=null?h._("__JHASH__zbO84srNMHF__JHASH__",[h._param("first name",a)]):h._("__JHASH__I-2GRtvMpnJ__JHASH__")}g.useUnsendContentInSecureThread=a}),98);